local encoded = "LS0gVm9ydGV4J3MgSGVscGVyIC0gUHJlbWl1bSBWZXJzaW9uCi0tIEZlYXR1cmVzOiBJbmYgSnVtcCwgRkxZIFRPIEJBU0UsIEZQUyBEZXZvdXJlciwgRVNQIEJhc2UsIEVTUCBCZXN0LCBEZXlzbmMsIFBsYXllciBFU1AsIFN0ZWFsIEZsb29yCgpsb2NhbCBQbGF5ZXJzID0gZ2FtZTpHZXRTZXJ2aWNlKCdQbGF5ZXJzJykKbG9jYWwgUmVwbGljYXRlZFN0b3JhZ2UgPSBnYW1lOkdldFNlcnZpY2UoJ1JlcGxpY2F0ZWRTdG9yYWdlJykKbG9jYWwgVXNlcklucHV0U2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgnVXNlcklucHV0U2VydmljZScpCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWU6R2V0U2VydmljZSgnV29ya3NwYWNlJykKbG9jYWwgUnVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgnUnVuU2VydmljZScpCmxvY2FsIFR3ZWVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgnVHdlZW5TZXJ2aWNlJykKbG9jYWwgQ29yZUd1aSA9IGdhbWU6R2V0U2VydmljZSgnQ29yZUd1aScpCmxvY2FsIEh0dHBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKCdIdHRwU2VydmljZScpCmxvY2FsIFByb3hpbWl0eVByb21wdFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoJ1Byb3hpbWl0eVByb21wdFNlcnZpY2UnKQpsb2NhbCBwbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCgotLSBTZXR0aW5ncyBmb2xkZXIKbG9jYWwgVm9ydGV4Rm9sZGVyID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCJWb3J0ZXgnc0hlbHBlciIpCmlmIG5vdCBWb3J0ZXhGb2xkZXIgdGhlbgogICAgVm9ydGV4Rm9sZGVyID0gSW5zdGFuY2UubmV3KCJGb2xkZXIiKQogICAgVm9ydGV4Rm9sZGVyLk5hbWUgPSAiVm9ydGV4J3NIZWxwZXIiCiAgICBWb3J0ZXhGb2xkZXIuUGFyZW50ID0gV29ya3NwYWNlCmVuZAoKLS0gU2F2ZS9Mb2FkIHNldHRpbmdzCmxvY2FsIGZ1bmN0aW9uIHNhdmVTZXR0aW5ncygpCiAgICBsb2NhbCBzZXR0aW5ncyA9IHsKICAgICAgICBpbmZKdW1wID0gZ3Jhdml0eUxvdywKICAgICAgICBlc3BCYXNlID0gZXNwQmFzZUFjdGl2ZSwKICAgICAgICBlc3BCZXN0ID0gZXNwQmVzdEFjdGl2ZSwKICAgICAgICBkZXN5bmMgPSBhbnRpSGl0QWN0aXZlLAogICAgICAgIGZwc0Rldm91cmVyID0gZnBzRGV2b3VyZXJBY3RpdmUsCiAgICAgICAgcGxheWVyRVNQID0gcGxheWVyRXNwQWN0aXZlLAogICAgICAgIHN0ZWFsRmxvb3IgPSBzdGVhbEZsb29yQWN0aXZlCiAgICB9CiAgICAKICAgIGxvY2FsIHN1Y2Nlc3MsIHJlc3VsdCA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBqc29uID0gSHR0cFNlcnZpY2U6SlNPTkVuY29kZShzZXR0aW5ncykKICAgICAgICBWb3J0ZXhGb2xkZXI6U2V0QXR0cmlidXRlKCJTZXR0aW5ncyIsIGpzb24pCiAgICBlbmQpCiAgICAKICAgIHJldHVybiBzdWNjZXNzCmVuZAoKbG9jYWwgZnVuY3Rpb24gbG9hZFNldHRpbmdzKCkKICAgIGxvY2FsIHNhdmVkID0gVm9ydGV4Rm9sZGVyOkdldEF0dHJpYnV0ZSgiU2V0dGluZ3MiKQogICAgaWYgc2F2ZWQgdGhlbgogICAgICAgIGxvY2FsIHN1Y2Nlc3MsIHNldHRpbmdzID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICByZXR1cm4gSHR0cFNlcnZpY2U6SlNPTkRlY29kZShzYXZlZCkKICAgICAgICBlbmQpCiAgICAgICAgCiAgICAgICAgaWYgc3VjY2VzcyBhbmQgc2V0dGluZ3MgdGhlbgogICAgICAgICAgICByZXR1cm4gc2V0dGluZ3MKICAgICAgICBlbmQKICAgIGVuZAogICAgcmV0dXJuIHt9CmVuZAoKLS0gTm90aWZpY2F0aW9uIFN5c3RlbSAoU2FkZWNlIHNjcmlwdCBiYcWfbGFuZ8SxY8SxbmRhKQpsb2NhbCBzdGFydHVwTm90aWZpY2F0aW9ucyA9IHRydWUKbG9jYWwgZnVuY3Rpb24gc2hvd05vdGlmaWNhdGlvbihtZXNzYWdlLCBpc1N1Y2Nlc3MpCiAgICBpZiBub3Qgc3RhcnR1cE5vdGlmaWNhdGlvbnMgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIGxvY2FsIG5vdGlmaWNhdGlvbkd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKICAgIG5vdGlmaWNhdGlvbkd1aS5OYW1lID0gIlZvcnRleE5vdGlmeSIKICAgIG5vdGlmaWNhdGlvbkd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQogICAgbm90aWZpY2F0aW9uR3VpLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5TaWJsaW5nCiAgICBub3RpZmljYXRpb25HdWkuUGFyZW50ID0gQ29yZUd1aQogICAgCiAgICBsb2NhbCBub3RpZmljYXRpb24gPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgIG5vdGlmaWNhdGlvbi5TaXplID0gVURpbTIubmV3KDAsIDIyMCwgMCwgNTApCiAgICBub3RpZmljYXRpb24uUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAtMTEwLCAwLjE1LCAwKQogICAgbm90aWZpY2F0aW9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxNSwgMTUsIDIwKQogICAgbm90aWZpY2F0aW9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwCiAgICBub3RpZmljYXRpb24uQm9yZGVyU2l6ZVBpeGVsID0gMAogICAgbm90aWZpY2F0aW9uLlpJbmRleCA9IDEwMDAKICAgIG5vdGlmaWNhdGlvbi5DbGlwc0Rlc2NlbmRhbnRzID0gdHJ1ZQogICAgbm90aWZpY2F0aW9uLlBhcmVudCA9IG5vdGlmaWNhdGlvbkd1aQogICAgCiAgICBsb2NhbCBub3RpZkNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQogICAgbm90aWZDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgOCkKICAgIG5vdGlmQ29ybmVyLlBhcmVudCA9IG5vdGlmaWNhdGlvbgogICAgCiAgICBsb2NhbCBub3RpZlN0cm9rZSA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiKQogICAgbm90aWZTdHJva2UuQ29sb3IgPSBpc1N1Y2Nlc3MgYW5kIENvbG9yMy5mcm9tUkdCKDAsIDI1NSwgMTAwKSBvciBDb2xvcjMuZnJvbVJHQigyNTUsIDUwLCA1MCkKICAgIG5vdGlmU3Ryb2tlLlRoaWNrbmVzcyA9IDIKICAgIG5vdGlmU3Ryb2tlLlBhcmVudCA9IG5vdGlmaWNhdGlvbgogICAgCiAgICBsb2NhbCBpY29uID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgaWNvbi5TaXplID0gVURpbTIubmV3KDAsIDQwLCAxLCAwKQogICAgaWNvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCAwKQogICAgaWNvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgaWNvbi5UZXh0ID0gaXNTdWNjZXNzIGFuZCAi4pyFIiBvciAi4p2MIgogICAgaWNvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIGljb24uVGV4dFNpemUgPSAxOAogICAgaWNvbi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKICAgIGljb24uWkluZGV4ID0gMTAwMQogICAgaWNvbi5QYXJlbnQgPSBub3RpZmljYXRpb24KICAgIAogICAgbG9jYWwgbm90aWZUZXh0ID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgbm90aWZUZXh0LlNpemUgPSBVRGltMi5uZXcoMSwgLTQ1LCAxLCAtMTApCiAgICBub3RpZlRleHQuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgNDAsIDAsIDUpCiAgICBub3RpZlRleHQuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIG5vdGlmVGV4dC5UZXh0ID0gbWVzc2FnZQogICAgbm90aWZUZXh0LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgbm90aWZUZXh0LlRleHRTaXplID0gMTIKICAgIG5vdGlmVGV4dC5Gb250ID0gRW51bS5Gb250LkdvdGhhbQogICAgbm90aWZUZXh0LlRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5MZWZ0CiAgICBub3RpZlRleHQuVGV4dFlBbGlnbm1lbnQgPSBFbnVtLlRleHRZQWxpZ25tZW50LlRvcAogICAgbm90aWZUZXh0LlRleHRXcmFwcGVkID0gdHJ1ZQogICAgbm90aWZUZXh0LlpJbmRleCA9IDEwMDEKICAgIG5vdGlmVGV4dC5QYXJlbnQgPSBub3RpZmljYXRpb24KICAgIAogICAgbm90aWZpY2F0aW9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTExMCwgMC4xLCAwKQogICAgbG9jYWwgdHdlZW5JbiA9IFR3ZWVuU2VydmljZTpDcmVhdGUobm90aWZpY2F0aW9uLCBUd2VlbkluZm8ubmV3KDAuNCwgRW51bS5FYXNpbmdTdHlsZS5CYWNrLCBFbnVtLkVhc2luZ0RpcmVjdGlvbi5PdXQpLCB7CiAgICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAtMTEwLCAwLjE1LCAwKQogICAgfSkKICAgIHR3ZWVuSW46UGxheSgpCgogICAgdHdlZW5Jbi5Db21wbGV0ZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgd2FpdCgxLjIpCiAgICAgICAgCiAgICAgICAgaWYgbm90aWZpY2F0aW9uIGFuZCBub3RpZmljYXRpb24uUGFyZW50IHRoZW4KICAgICAgICAgICAgbG9jYWwgdHdlZW5PdXQgPSBUd2VlblNlcnZpY2U6Q3JlYXRlKG5vdGlmaWNhdGlvbiwgVHdlZW5JbmZvLm5ldygwLjQsIEVudW0uRWFzaW5nU3R5bGUuQmFjaywgRW51bS5FYXNpbmdEaXJlY3Rpb24uSW4pLCB7CiAgICAgICAgICAgICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC0xMTAsIDAuMSwgMCksCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIF8sIGNoaWxkIGluIHBhaXJzKG5vdGlmaWNhdGlvbjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgY2hpbGQ6SXNBKCJUZXh0TGFiZWwiKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgY2hpbGQuVGV4dFRyYW5zcGFyZW5jeSA9IDEKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIHR3ZWVuT3V0OlBsYXkoKQogICAgICAgICAgICAKICAgICAgICAgICAgdHdlZW5PdXQuQ29tcGxldGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgaWYgbm90aWZpY2F0aW9uR3VpIGFuZCBub3RpZmljYXRpb25HdWkuUGFyZW50IHRoZW4KICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25HdWk6RGVzdHJveSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0gRlBTIERFVk9VUkVSCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KbG9jYWwgZnBzRGV2b3VyZXJBY3RpdmUgPSBmYWxzZQoKbG9jYWwgZnVuY3Rpb24gZW5hYmxlRlBTRGV2b3VyZXIoKQogICAgZnBzRGV2b3VyZXJBY3RpdmUgPSB0cnVlCiAgICAKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBpZiBzZXRmcHNjYXAgdGhlbgogICAgICAgICAgICBzZXRmcHNjYXAoOTk5KQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBmb3IgXywgbGlnaHRpbmcgaW4gcGFpcnMoV29ya3NwYWNlOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgbGlnaHRpbmc6SXNBKCJQYXJ0Iikgb3IgbGlnaHRpbmc6SXNBKCJVbmlvbk9wZXJhdGlvbiIpIG9yIGxpZ2h0aW5nOklzQSgiTWVzaFBhcnQiKSB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGxpZ2h0aW5nLk1hdGVyaWFsID0gRW51bS5NYXRlcmlhbC5QbGFzdGljCiAgICAgICAgICAgICAgICBsaWdodGluZy5SZWZsZWN0YW5jZSA9IDAKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGxvY2FsIGxpZ2h0aW5nID0gZ2FtZTpHZXRTZXJ2aWNlKCJMaWdodGluZyIpCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbGlnaHRpbmcuR2xvYmFsU2hhZG93cyA9IGZhbHNlCiAgICAgICAgbGlnaHRpbmcuRm9nRW5kID0gMTAwMDAwCiAgICAgICAgbGlnaHRpbmcuQnJpZ2h0bmVzcyA9IDIKICAgIGVuZCkKICAgIAogICAgcGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2hhcikKICAgICAgICB3YWl0KDAuNSkKICAgICAgICBmb3IgXywgcGFydCBpbiBwYWlycyhjaGFyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICBwYXJ0Lk1hdGVyaWFsID0gRW51bS5NYXRlcmlhbC5QbGFzdGljCiAgICAgICAgICAgICAgICAgICAgcGFydC5SZWZsZWN0YW5jZSA9IDAKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIHNhdmVTZXR0aW5ncygpCmVuZAoKbG9jYWwgZnVuY3Rpb24gZGlzYWJsZUZQU0Rldm91cmVyKCkKICAgIGZwc0Rldm91cmVyQWN0aXZlID0gZmFsc2UKICAgIAogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGlmIHNldGZwc2NhcCB0aGVuCiAgICAgICAgICAgIHNldGZwc2NhcCg2MCkKICAgICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgbG9jYWwgbGlnaHRpbmcgPSBnYW1lOkdldFNlcnZpY2UoIkxpZ2h0aW5nIikKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsaWdodGluZy5HbG9iYWxTaGFkb3dzID0gdHJ1ZQogICAgICAgIGxpZ2h0aW5nLkJyaWdodG5lc3MgPSAxCiAgICBlbmQpCiAgICAKICAgIHNhdmVTZXR0aW5ncygpCmVuZAoKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlRlBTRGV2b3VyZXIoKQogICAgaWYgZnBzRGV2b3VyZXJBY3RpdmUgdGhlbgogICAgICAgIGRpc2FibGVGUFNEZXZvdXJlcigpCiAgICBlbHNlCiAgICAgICAgZW5hYmxlRlBTRGV2b3VyZXIoKQogICAgZW5kCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSBJTkYgSlVNUCAvIEpVTVAgQk9PU1QgKDMwIFBPV0VSKSAtIFdhbGsgU3BlZWQgWU9LCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KbG9jYWwgTk9STUFMX0dSQVYgPSAxOTYuMgpsb2NhbCBSRURVQ0VEX0dSQVYgPSA0MApsb2NhbCBOT1JNQUxfSlVNUCA9IDMwCmxvY2FsIEJPT1NUX0pVTVAgPSAzMAoKbG9jYWwgc3Bvb2ZlZEdyYXZpdHkgPSBOT1JNQUxfR1JBVgpwY2FsbChmdW5jdGlvbigpCiAgICBsb2NhbCBtdCA9IGdldHJhd21ldGF0YWJsZShXb3Jrc3BhY2UpCiAgICBpZiBtdCB0aGVuCiAgICAgICAgc2V0cmVhZG9ubHkobXQsIGZhbHNlKQogICAgICAgIGxvY2FsIG9sZEluZGV4ID0gbXQuX19pbmRleAogICAgICAgIG10Ll9faW5kZXggPSBmdW5jdGlvbihzZWxmLCBrKQogICAgICAgICAgICBpZiBrID09ICdHcmF2aXR5JyB0aGVuCiAgICAgICAgICAgICAgICByZXR1cm4gc3Bvb2ZlZEdyYXZpdHkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHJldHVybiBvbGRJbmRleChzZWxmLCBrKQogICAgICAgIGVuZAogICAgICAgIHNldHJlYWRvbmx5KG10LCB0cnVlKQogICAgZW5kCmVuZCkKCmxvY2FsIGdyYXZpdHlMb3cgPSBmYWxzZQpsb2NhbCBzb3VyY2VBY3RpdmUgPSBmYWxzZQoKbG9jYWwgZnVuY3Rpb24gc2V0SnVtcFBvd2VyKGp1bXApCiAgICBsb2NhbCBoID0gcGxheWVyLkNoYXJhY3RlciBhbmQgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoJ0h1bWFub2lkJykKICAgIGlmIGggdGhlbgogICAgICAgIGguSnVtcFBvd2VyID0ganVtcAogICAgICAgIGguVXNlSnVtcFBvd2VyID0gdHJ1ZQogICAgZW5kCmVuZAoKbG9jYWwgaW5maW5pdGVKdW1wQ29ubgpsb2NhbCBmdW5jdGlvbiBlbmFibGVJbmZpbml0ZUp1bXAoc3RhdGUpCiAgICBpZiBpbmZpbml0ZUp1bXBDb25uIHRoZW4KICAgICAgICBpbmZpbml0ZUp1bXBDb25uOkRpc2Nvbm5lY3QoKQogICAgICAgIGluZmluaXRlSnVtcENvbm4gPSBuaWwKICAgIGVuZAogICAgaWYgc3RhdGUgdGhlbgogICAgICAgIGluZmluaXRlSnVtcENvbm4gPSBVc2VySW5wdXRTZXJ2aWNlLkp1bXBSZXF1ZXN0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBsb2NhbCBoID0gcGxheWVyLkNoYXJhY3RlciBhbmQgcGxheWVyLkNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoJ0h1bWFub2lkJykKICAgICAgICAgICAgaWYgaCBhbmQgZ3Jhdml0eUxvdyBhbmQgaDpHZXRTdGF0ZSgpIH49IEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuU2VhdGVkIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIHJvb3QgPSBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCdIdW1hbm9pZFJvb3RQYXJ0JykKICAgICAgICAgICAgICAgIGlmIHJvb3QgdGhlbgogICAgICAgICAgICAgICAgICAgIHJvb3QuVmVsb2NpdHkgPSBWZWN0b3IzLm5ldygKICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5WZWxvY2l0eS5YLAogICAgICAgICAgICAgICAgICAgICAgICBoLkp1bXBQb3dlciwKICAgICAgICAgICAgICAgICAgICAgICAgcm9vdC5WZWxvY2l0eS5aCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIGFudGlSYWdkb2xsKCkKICAgIGxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICBpZiBjaGFyIHRoZW4KICAgICAgICBmb3IgXywgdiBpbiBwYWlycyhjaGFyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgIGlmIHY6SXNBKCdCb2R5VmVsb2NpdHknKSBvciB2OklzQSgnQm9keUFuZ3VsYXJWZWxvY2l0eScpIHRoZW4KICAgICAgICAgICAgICAgIHY6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlRm9yY2VGaWVsZCgpCiAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciB0aGVuCiAgICAgICAgaWYgZ3Jhdml0eUxvdyB0aGVuCiAgICAgICAgICAgIGlmIG5vdCBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygnRm9yY2VGaWVsZCcpIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGZmID0gSW5zdGFuY2UubmV3KCdGb3JjZUZpZWxkJywgY2hhcikKICAgICAgICAgICAgICAgIGZmLlZpc2libGUgPSBmYWxzZQogICAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZvciBfLCBmZiBpbiBpcGFpcnMoY2hhcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICAgICAgaWYgZmY6SXNBKCdGb3JjZUZpZWxkJykgdGhlbgogICAgICAgICAgICAgICAgICAgIGZmOkRlc3Ryb3koKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gc3dpdGNoR3Jhdml0eUp1bXAoKQogICAgZ3Jhdml0eUxvdyA9IG5vdCBncmF2aXR5TG93CiAgICBzb3VyY2VBY3RpdmUgPSBncmF2aXR5TG93CiAgICBXb3Jrc3BhY2UuR3Jhdml0eSA9IGdyYXZpdHlMb3cgYW5kIFJFRFVDRURfR1JBViBvciBOT1JNQUxfR1JBVgogICAgc2V0SnVtcFBvd2VyKGdyYXZpdHlMb3cgYW5kIEJPT1NUX0pVTVAgb3IgTk9STUFMX0pVTVApCiAgICBlbmFibGVJbmZpbml0ZUp1bXAoZ3Jhdml0eUxvdykKICAgIGFudGlSYWdkb2xsKCkKICAgIHRvZ2dsZUZvcmNlRmllbGQoKQogICAgc3Bvb2ZlZEdyYXZpdHkgPSBOT1JNQUxfR1JBVgogICAgCiAgICBzYXZlU2V0dGluZ3MoKQplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0gRkxZIFRPIEJBU0UKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpsb2NhbCBmbHlBY3RpdmUgPSBmYWxzZQpsb2NhbCBmbHlDb25uCmxvY2FsIGZseUF0dCwgZmx5TFYKbG9jYWwgZmx5Q2hhclJlbW92aW5nQ29ubgpsb2NhbCBkZXN0VG91Y2hlZENvbm4KbG9jYWwgZGVzdFBhcnRSZWYKbG9jYWwgZmx5UmVzdG9yZU9sZEdyYXZpdHksIGZseVJlc3RvcmVPbGRKdW1wUG93ZXIKCmxvY2FsIEZMWV9HUkFWID0gMjAKbG9jYWwgRkxZX0pVTVAgPSA3CmxvY2FsIEZMWV9TVE9QRElTVCA9IDcKbG9jYWwgRkxZX1haX1NQRUVEID0gMjIKbG9jYWwgRkxZX1lfQkFTRSA9IC0xLjAKbG9jYWwgRkxZX1lfTUFYID0gLTIuMgpsb2NhbCBGTFlfVElNRV9TVEVQID0gMS41Cgpsb2NhbCBmdW5jdGlvbiBjbGVhckZseUNvbm5lY3Rpb25zKCkKICAgIGlmIGZseUNvbm4gdGhlbgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgZmx5Q29ubjpEaXNjb25uZWN0KCkKICAgICAgICBlbmQpCiAgICAgICAgZmx5Q29ubiA9IG5pbAogICAgZW5kCiAgICBpZiBmbHlDaGFyUmVtb3ZpbmdDb25uIHRoZW4KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGZseUNoYXJSZW1vdmluZ0Nvbm46RGlzY29ubmVjdCgpCiAgICAgICAgZW5kKQogICAgICAgIGZseUNoYXJSZW1vdmluZ0Nvbm4gPSBuaWwKICAgIGVuZAogICAgaWYgZGVzdFRvdWNoZWRDb25uIHRoZW4KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGRlc3RUb3VjaGVkQ29ubjpEaXNjb25uZWN0KCkKICAgICAgICBlbmQpCiAgICAgICAgZGVzdFRvdWNoZWRDb25uID0gbmlsCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBkZXN0cm95Rmx5Qm9kaWVzKCkKICAgIGlmIGZseUxWIHRoZW4KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGZseUxWOkRlc3Ryb3koKQogICAgICAgIGVuZCkKICAgICAgICBmbHlMViA9IG5pbAogICAgZW5kCiAgICBpZiBmbHlBdHQgdGhlbgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgZmx5QXR0OkRlc3Ryb3koKQogICAgICAgIGVuZCkKICAgICAgICBmbHlBdHQgPSBuaWwKICAgIGVuZAogICAgZGVzdFBhcnRSZWYgPSBuaWwKZW5kCgpsb2NhbCBmdW5jdGlvbiBmaW5kTXlEZWxpdmVyeVBhcnQoKQogICAgbG9jYWwgcGxvdHMgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoJ1Bsb3RzJykKICAgIGlmIHBsb3RzIHRoZW4KICAgICAgICBmb3IgXywgcGxvdCBpbiBpcGFpcnMocGxvdHM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgICAgbG9jYWwgc2lnbiA9IHBsb3Q6RmluZEZpcnN0Q2hpbGQoJ1Bsb3RTaWduJykKICAgICAgICAgICAgaWYgc2lnbiBhbmQgc2lnbjpGaW5kRmlyc3RDaGlsZCgnWW91ckJhc2UnKSBhbmQgc2lnbi5Zb3VyQmFzZS5FbmFibGVkIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGRlbGl2ZXJ5ID0gcGxvdDpGaW5kRmlyc3RDaGlsZCgnRGVsaXZlcnlIaXRib3gnKQogICAgICAgICAgICAgICAgaWYgZGVsaXZlcnkgYW5kIGRlbGl2ZXJ5OklzQSgnQmFzZVBhcnQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlbGl2ZXJ5CiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKICAgIHJldHVybiBuaWwKZW5kCgpsb2NhbCBmdW5jdGlvbiBmbHlHZXREZXNjZW50KGRpc3QpCiAgICBsb2NhbCBtYXhkaXN0ID0gMjAwCiAgICBkaXN0ID0gbWF0aC5jbGFtcChkaXN0LCAwLCBtYXhkaXN0KQogICAgbG9jYWwgdCA9IDEgLSAoZGlzdCAvIG1heGRpc3QpCiAgICByZXR1cm4gRkxZX1lfQkFTRSArIChGTFlfWV9NQVggLSBGTFlfWV9CQVNFKSAqIHQKZW5kCgpsb2NhbCBmdW5jdGlvbiByZXN0b3JlU291cmNlQW5kUGh5c2ljcygpCiAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgogICAgbG9jYWwgaHVtID0gY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoJ0h1bWFub2lkJykKICAgIGlmIGh1bSB0aGVuCiAgICAgICAgaWYgZ3Jhdml0eUxvdyB0aGVuCiAgICAgICAgICAgIFdvcmtzcGFjZS5HcmF2aXR5ID0gUkVEVUNFRF9HUkFWCiAgICAgICAgICAgIHNldEp1bXBQb3dlcihCT09TVF9KVU1QKQogICAgICAgICAgICBlbmFibGVJbmZpbml0ZUp1bXAodHJ1ZSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIFdvcmtzcGFjZS5HcmF2aXR5ID0gTk9STUFMX0dSQVYKICAgICAgICAgICAgc2V0SnVtcFBvd2VyKE5PUk1BTF9KVU1QKQogICAgICAgICAgICBlbmFibGVJbmZpbml0ZUp1bXAoZmFsc2UpCiAgICAgICAgZW5kCiAgICAgICAgc3Bvb2ZlZEdyYXZpdHkgPSBOT1JNQUxfR1JBVgogICAgZWxzZQogICAgICAgIFdvcmtzcGFjZS5HcmF2aXR5ID0gZmx5UmVzdG9yZU9sZEdyYXZpdHkgb3IgTk9STUFMX0dSQVYKICAgICAgICBzcG9vZmVkR3Jhdml0eSA9IE5PUk1BTF9HUkFWCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBodW0gYW5kIGZseVJlc3RvcmVPbGRKdW1wUG93ZXIgdGhlbgogICAgICAgICAgICAgICAgaHVtLkp1bXBQb3dlciA9IGZseVJlc3RvcmVPbGRKdW1wUG93ZXIKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kKQogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gY2xlYW51cEZseSgpCiAgICBjbGVhckZseUNvbm5lY3Rpb25zKCkKICAgIGRlc3Ryb3lGbHlCb2RpZXMoKQogICAgcmVzdG9yZVNvdXJjZUFuZFBoeXNpY3MoKQogICAgZmx5QWN0aXZlID0gZmFsc2UKZW5kCgpsb2NhbCBmdW5jdGlvbiBmaW5pc2hGbHkoc3VjY2VzcykKICAgIGNsZWFudXBGbHkoKQplbmQKCmxvY2FsIGZ1bmN0aW9uIHN0YXJ0Rmx5VG9CYXNlKCkKICAgIGlmIGZseUFjdGl2ZSB0aGVuCiAgICAgICAgZmluaXNoRmx5KGZhbHNlKQogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgZGVzdFBhcnQgPSBmaW5kTXlEZWxpdmVyeVBhcnQoKQogICAgaWYgbm90IGRlc3RQYXJ0IHRoZW4KICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGxvY2FsIGNoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICBsb2NhbCBodW0gPSBjaGFyIGFuZCBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygnSHVtYW5vaWQnKQogICAgbG9jYWwgaHJwID0gY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgnSHVtYW5vaWRSb290UGFydCcpCiAgICBpZiBub3QgKGh1bSBhbmQgaHJwKSB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBlbmQKCiAgICBmbHlSZXN0b3JlT2xkR3Jhdml0eSA9IFdvcmtzcGFjZS5HcmF2aXR5CiAgICBmbHlSZXN0b3JlT2xkSnVtcFBvd2VyID0gaHVtLkp1bXBQb3dlcgoKICAgIGVuYWJsZUluZmluaXRlSnVtcChmYWxzZSkKCiAgICBXb3Jrc3BhY2UuR3Jhdml0eSA9IEZMWV9HUkFWCiAgICBzcG9vZmVkR3Jhdml0eSA9IE5PUk1BTF9HUkFWCiAgICBodW0uVXNlSnVtcFBvd2VyID0gdHJ1ZQogICAgaHVtLkp1bXBQb3dlciA9IEZMWV9KVU1QCgogICAgZmx5QWN0aXZlID0gdHJ1ZQoKICAgIGZseUF0dCA9IEluc3RhbmNlLm5ldygnQXR0YWNobWVudCcpCiAgICBmbHlBdHQuTmFtZSA9ICdGbHlUb0Jhc2VBdHRhY2htZW50JwogICAgZmx5QXR0LlBhcmVudCA9IGhycAoKICAgIGZseUxWID0gSW5zdGFuY2UubmV3KCdMaW5lYXJWZWxvY2l0eScpCiAgICBmbHlMVi5BdHRhY2htZW50MCA9IGZseUF0dAogICAgZmx5TFYuUmVsYXRpdmVUbyA9IEVudW0uQWN0dWF0b3JSZWxhdGl2ZVRvLldvcmxkCiAgICBmbHlMVi5NYXhGb3JjZSA9IG1hdGguaHVnZQogICAgZmx5TFYuUGFyZW50ID0gaHJwCgogICAgZGVzdFBhcnRSZWYgPSBkZXN0UGFydAoKICAgIGxvY2FsIHJlYWNoZWQgPSBmYWxzZQogICAgbG9jYWwgbGFzdFlVcGRhdGUgPSAwCgogICAgZG8KICAgICAgICBsb2NhbCBwb3MgPSBocnAuUG9zaXRpb24KICAgICAgICBsb2NhbCBkZXN0UG9zID0gZGVzdFBhcnQuUG9zaXRpb24KICAgICAgICBsb2NhbCBkaXN0WFogPSAoVmVjdG9yMy5uZXcoZGVzdFBvcy5YLCBwb3MuWSwgZGVzdFBvcy5aKSAtIHBvcykuTWFnbml0dWRlCiAgICAgICAgbG9jYWwgeVZlbCA9IGZseUdldERlc2NlbnQoZGlzdFhaKQogICAgICAgIGxvY2FsIGRpclhaID0gVmVjdG9yMy5uZXcoZGVzdFBvcy5YIC0gcG9zLlgsIDAsIGRlc3RQb3MuWiAtIHBvcy5aKQogICAgICAgIGlmIGRpclhaLk1hZ25pdHVkZSA+IDAgdGhlbgogICAgICAgICAgICBkaXJYWiA9IGRpclhaLlVuaXQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGRpclhaID0gVmVjdG9yMy5uZXcoKQogICAgICAgIGVuZAogICAgICAgIGZseUxWLlZlY3RvclZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoZGlyWFouWCAqIEZMWV9YWl9TUEVFRCwgeVZlbCwgZGlyWFouWiAqIEZMWV9YWl9TUEVFRCkKICAgICAgICBsYXN0WVVwZGF0ZSA9IHRpY2soKQogICAgZW5kCgogICAgZGVzdFRvdWNoZWRDb25uID0gZGVzdFBhcnQuVG91Y2hlZDpDb25uZWN0KGZ1bmN0aW9uKGhpdCkKICAgICAgICBpZiBub3QgZmx5QWN0aXZlIHRoZW4KICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgbG9jYWwgY2ggPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgaWYgY2ggYW5kIGhpdCBhbmQgaGl0OklzRGVzY2VuZGFudE9mKGNoKSB0aGVuCiAgICAgICAgICAgIHJlYWNoZWQgPSB0cnVlCiAgICAgICAgICAgIGZpbmlzaEZseSh0cnVlKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIGlmIGZseUNvbm4gdGhlbgogICAgICAgIGZseUNvbm46RGlzY29ubmVjdCgpCiAgICAgICAgZmx5Q29ubiA9IG5pbAogICAgZW5kCiAgICBmbHlDb25uID0gUnVuU2VydmljZS5IZWFydGJlYXQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgbm90IGZseUFjdGl2ZSB0aGVuCiAgICAgICAgICAgIGNsZWFudXBGbHkoKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKCiAgICAgICAgaWYgbm90IChocnAgYW5kIGhycC5QYXJlbnQgYW5kIGh1bSBhbmQgaHVtLlBhcmVudCkgdGhlbgogICAgICAgICAgICBmaW5pc2hGbHkoZmFsc2UpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAoKICAgICAgICBsb2NhbCBwb3MgPSBocnAuUG9zaXRpb24KICAgICAgICBsb2NhbCBkZXN0UG9zID0gZGVzdFBhcnQuUG9zaXRpb24KICAgICAgICBsb2NhbCBkaXN0WFogPSAoVmVjdG9yMy5uZXcoZGVzdFBvcy5YLCBwb3MuWSwgZGVzdFBvcy5aKSAtIHBvcykuTWFnbml0dWRlCgogICAgICAgIGlmIGRpc3RYWiA8IEZMWV9TVE9QRElTVCBhbmQgbm90IHJlYWNoZWQgdGhlbgogICAgICAgICAgICByZWFjaGVkID0gdHJ1ZQogICAgICAgICAgICBmaW5pc2hGbHkodHJ1ZSkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCgogICAgICAgIGlmIHRpY2soKSAtIGxhc3RZVXBkYXRlID49IEZMWV9USU1FX1NURVAgdGhlbgogICAgICAgICAgICBsb2NhbCB5VmVsID0gZmx5R2V0RGVzY2VudChkaXN0WFopCiAgICAgICAgICAgIGxvY2FsIGRpclhaID0gVmVjdG9yMy5uZXcoZGVzdFBvcy5YIC0gcG9zLlgsIDAsIGRlc3RQb3MuWiAtIHBvcy5aKQogICAgICAgICAgICBpZiBkaXJYWi5NYWduaXR1ZGUgPiAwIHRoZW4KICAgICAgICAgICAgICAgIGRpclhaID0gZGlyWFouVW5pdAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBkaXJYWiA9IFZlY3RvcjMubmV3KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGZseUxWLlZlY3RvclZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoCiAgICAgICAgICAgICAgICBkaXJYWi5YICogRkxZX1haX1NQRUVELAogICAgICAgICAgICAgICAgeVZlbCwKICAgICAgICAgICAgICAgIGRpclhaLlogKiBGTFlfWFpfU1BFRUQKICAgICAgICAgICAgKQogICAgICAgICAgICBsYXN0WVVwZGF0ZSA9IHRpY2soKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIGlmIGZseUNoYXJSZW1vdmluZ0Nvbm4gdGhlbgogICAgICAgIGZseUNoYXJSZW1vdmluZ0Nvbm46RGlzY29ubmVjdCgpCiAgICAgICAgZmx5Q2hhclJlbW92aW5nQ29ubiA9IG5pbAogICAgZW5kCiAgICBmbHlDaGFyUmVtb3ZpbmdDb25uID0gcGxheWVyLkNoYXJhY3RlclJlbW92aW5nOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIGZseUFjdGl2ZSB0aGVuCiAgICAgICAgICAgIGZpbmlzaEZseShmYWxzZSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGNsZWFudXBGbHkoKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0gRVNQIEJBU0UKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpsb2NhbCBlc3BCYXNlQWN0aXZlID0gZmFsc2UKbG9jYWwgYmFzZUVzcE9iamVjdHMgPSB7fQoKbG9jYWwgZnVuY3Rpb24gY2xlYXJCYXNlRVNQKCkKICAgIGZvciBfLCBvYmogaW4gcGFpcnMoYmFzZUVzcE9iamVjdHMpIGRvCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBvYmo6RGVzdHJveSgpCiAgICAgICAgZW5kKQogICAgZW5kCiAgICBiYXNlRXNwT2JqZWN0cyA9IHt9CmVuZAoKbG9jYWwgZnVuY3Rpb24gdXBkYXRlQmFzZUVTUCgpCiAgICBpZiBub3QgZXNwQmFzZUFjdGl2ZSB0aGVuIHJldHVybiBlbmQKICAgIAogICAgY2xlYXJCYXNlRVNQKCkKICAgIAogICAgbG9jYWwgcGxvdHMgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQoJ1Bsb3RzJykKICAgIGlmIG5vdCBwbG90cyB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBteVBsb3ROYW1lCiAgICBmb3IgXywgcGxvdCBpbiBwYWlycyhwbG90czpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGxvY2FsIHBsb3RTaWduID0gcGxvdDpGaW5kRmlyc3RDaGlsZCgnUGxvdFNpZ24nKQogICAgICAgIGlmIHBsb3RTaWduIGFuZCBwbG90U2lnbjpGaW5kRmlyc3RDaGlsZCgnWW91ckJhc2UnKSBhbmQgcGxvdFNpZ24uWW91ckJhc2UuRW5hYmxlZCB0aGVuCiAgICAgICAgICAgIG15UGxvdE5hbWUgPSBwbG90Lk5hbWUKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGlmIG5vdCBteVBsb3ROYW1lIHRoZW4gcmV0dXJuIGVuZAoKICAgIGZvciBfLCBwbG90IGluIHBhaXJzKHBsb3RzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgaWYgcGxvdC5OYW1lIH49IG15UGxvdE5hbWUgdGhlbgogICAgICAgICAgICBsb2NhbCBwdXJjaGFzZXMgPSBwbG90OkZpbmRGaXJzdENoaWxkKCdQdXJjaGFzZXMnKQogICAgICAgICAgICBsb2NhbCBwYiA9IHB1cmNoYXNlcyBhbmQgcHVyY2hhc2VzOkZpbmRGaXJzdENoaWxkKCdQbG90QmxvY2snKQogICAgICAgICAgICBsb2NhbCBtYWluID0gcGIgYW5kIHBiOkZpbmRGaXJzdENoaWxkKCdNYWluJykKICAgICAgICAgICAgbG9jYWwgZ3VpID0gbWFpbiBhbmQgbWFpbjpGaW5kRmlyc3RDaGlsZCgnQmlsbGJvYXJkR3VpJykKICAgICAgICAgICAgbG9jYWwgdGltZUxiID0gZ3VpIGFuZCBndWk6RmluZEZpcnN0Q2hpbGQoJ1JlbWFpbmluZ1RpbWUnKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgdGltZUxiIGFuZCBtYWluIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGJpbGxib2FyZCA9IEluc3RhbmNlLm5ldygnQmlsbGJvYXJkR3VpJykKICAgICAgICAgICAgICAgIGJpbGxib2FyZC5OYW1lID0gJ0Jhc2VfRVNQJwogICAgICAgICAgICAgICAgYmlsbGJvYXJkLlNpemUgPSBVRGltMi5uZXcoMCwgMTQwLCAwLCAzNikKICAgICAgICAgICAgICAgIGJpbGxib2FyZC5TdHVkc09mZnNldCA9IFZlY3RvcjMubmV3KDAsIDUsIDApCiAgICAgICAgICAgICAgICBiaWxsYm9hcmQuQWx3YXlzT25Ub3AgPSB0cnVlCiAgICAgICAgICAgICAgICBiaWxsYm9hcmQuUGFyZW50ID0gbWFpbgoKICAgICAgICAgICAgICAgIGxvY2FsIGxhYmVsID0gSW5zdGFuY2UubmV3KCdUZXh0TGFiZWwnKQogICAgICAgICAgICAgICAgbGFiZWwuVGV4dCA9IHRpbWVMYi5UZXh0CiAgICAgICAgICAgICAgICBsYWJlbC5TaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApCiAgICAgICAgICAgICAgICBsYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgICAgICAgICAgbGFiZWwuVGV4dFNjYWxlZCA9IHRydWUKICAgICAgICAgICAgICAgIGxhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMjAsIDAsIDYwKQogICAgICAgICAgICAgICAgbGFiZWwuRm9udCA9IEVudW0uRm9udC5BcmNhZGUKICAgICAgICAgICAgICAgIGxhYmVsLlRleHRTdHJva2VUcmFuc3BhcmVuY3kgPSAwLjUKICAgICAgICAgICAgICAgIGxhYmVsLlRleHRTdHJva2VDb2xvcjMgPSBDb2xvcjMubmV3KDAsIDAsIDApCiAgICAgICAgICAgICAgICBsYWJlbC5QYXJlbnQgPSBiaWxsYm9hcmQKCiAgICAgICAgICAgICAgICB0YWJsZS5pbnNlcnQoYmFzZUVzcE9iamVjdHMsIGJpbGxib2FyZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpsb2NhbCBiYXNlRXNwTG9vcApsb2NhbCBmdW5jdGlvbiB0b2dnbGVCYXNlRVNQKCkKICAgIGVzcEJhc2VBY3RpdmUgPSBub3QgZXNwQmFzZUFjdGl2ZQogICAgCiAgICBpZiBiYXNlRXNwTG9vcCB0aGVuCiAgICAgICAgYmFzZUVzcExvb3A6RGlzY29ubmVjdCgpCiAgICAgICAgYmFzZUVzcExvb3AgPSBuaWwKICAgIGVuZAogICAgCiAgICBpZiBlc3BCYXNlQWN0aXZlIHRoZW4KICAgICAgICB1cGRhdGVCYXNlRVNQKCkKICAgICAgICBiYXNlRXNwTG9vcCA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBub3QgZXNwQmFzZUFjdGl2ZSB0aGVuCiAgICAgICAgICAgICAgICBiYXNlRXNwTG9vcDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIGJhc2VFc3BMb29wID0gbmlsCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHdhaXQoMikKICAgICAgICAgICAgdXBkYXRlQmFzZUVTUCgpCiAgICAgICAgZW5kKQogICAgZWxzZQogICAgICAgIGNsZWFyQmFzZUVTUCgpCiAgICBlbmQKICAgIHNhdmVTZXR0aW5ncygpCmVuZAoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSBFU1AgQkVTVAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmxvY2FsIGVzcEJlc3RBY3RpdmUgPSBmYWxzZQpsb2NhbCBiZXN0RXNwT2JqZWN0cyA9IHt9Cgpsb2NhbCBmdW5jdGlvbiBjbGVhckJlc3RFU1AoKQogICAgZm9yIF8sIG9iaiBpbiBwYWlycyhiZXN0RXNwT2JqZWN0cykgZG8KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIG9iajpEZXN0cm95KCkKICAgICAgICBlbmQpCiAgICBlbmQKICAgIGJlc3RFc3BPYmplY3RzID0ge30KZW5kCgpsb2NhbCBmdW5jdGlvbiBwYXJzZU1vbmV5UGVyU2VjKHRleHQpCiAgICBpZiBub3QgdGV4dCB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGVuZAogICAgbG9jYWwgbXVsdCA9IDEKICAgIGxvY2FsIG51bWJlclN0ciA9IHRleHQ6bWF0Y2goJ1slZCUuXSsnKQogICAgaWYgbm90IG51bWJlclN0ciB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGVuZAogICAgaWYgdGV4dDpmaW5kKCdLJykgdGhlbgogICAgICAgIG11bHQgPSAxXzAwMAogICAgZWxzZWlmIHRleHQ6ZmluZCgnTScpIHRoZW4KICAgICAgICBtdWx0ID0gMV8wMDBfMDAwCiAgICBlbHNlaWYgdGV4dDpmaW5kKCdCJykgdGhlbgogICAgICAgIG11bHQgPSAxXzAwMF8wMDBfMDAwCiAgICBlbHNlaWYgdGV4dDpmaW5kKCdUJykgdGhlbgogICAgICAgIG11bHQgPSAxXzAwMF8wMDBfMDAwXzAwMAogICAgZWxzZWlmIHRleHQ6ZmluZCgnUScpIHRoZW4KICAgICAgICBtdWx0ID0gMV8wMDBfMDAwXzAwMF8wMDBfMDAwCiAgICBlbmQKICAgIGxvY2FsIG51bWJlciA9IHRvbnVtYmVyKG51bWJlclN0cikKICAgIHJldHVybiBudW1iZXIgYW5kIG51bWJlciAqIG11bHQgb3IgMAplbmQKCmxvY2FsIGZ1bmN0aW9uIHVwZGF0ZUJlc3RFU1AoKQogICAgaWYgbm90IGVzcEJlc3RBY3RpdmUgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIGNsZWFyQmVzdEVTUCgpCiAgICAKICAgIGxvY2FsIHBsb3RzID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCdQbG90cycpCiAgICBpZiBub3QgcGxvdHMgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgbXlQbG90TmFtZQogICAgZm9yIF8sIHBsb3QgaW4gaXBhaXJzKHBsb3RzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgbG9jYWwgcGxvdFNpZ24gPSBwbG90OkZpbmRGaXJzdENoaWxkKCdQbG90U2lnbicpCiAgICAgICAgaWYgcGxvdFNpZ24gYW5kIHBsb3RTaWduOkZpbmRGaXJzdENoaWxkKCdZb3VyQmFzZScpIGFuZCBwbG90U2lnbi5Zb3VyQmFzZS5FbmFibGVkIHRoZW4KICAgICAgICAgICAgbXlQbG90TmFtZSA9IHBsb3QuTmFtZQogICAgICAgICAgICBicmVhawogICAgICAgIGVuZAogICAgZW5kCgogICAgbG9jYWwgYmVzdFBldEluZm8gPSBuaWwKCiAgICBmb3IgXywgcGxvdCBpbiBpcGFpcnMocGxvdHM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBwbG90Lk5hbWUgfj0gbXlQbG90TmFtZSB0aGVuCiAgICAgICAgICAgIGZvciBfLCBkZXNjIGluIGlwYWlycyhwbG90OkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBkZXNjOklzQSgnVGV4dExhYmVsJykgYW5kIGRlc2MuTmFtZSA9PSAnUmFyaXR5JyBhbmQgZGVzYy5QYXJlbnQgYW5kIGRlc2MuUGFyZW50OkZpbmRGaXJzdENoaWxkKCdEaXNwbGF5TmFtZScpIHRoZW4KICAgICAgICAgICAgICAgICAgICBsb2NhbCBwYXJlbnRNb2RlbCA9IGRlc2MuUGFyZW50LlBhcmVudAogICAgICAgICAgICAgICAgICAgIGxvY2FsIHJhcml0eSA9IGRlc2MuVGV4dAogICAgICAgICAgICAgICAgICAgIGxvY2FsIGRpc3BsYXlOYW1lID0gZGVzYy5QYXJlbnQuRGlzcGxheU5hbWUuVGV4dAoKICAgICAgICAgICAgICAgICAgICBpZiBlc3BCZXN0QWN0aXZlIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgZ2VuTGFiZWwgPSBkZXNjLlBhcmVudDpGaW5kRmlyc3RDaGlsZCgnR2VuZXJhdGlvbicpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGdlbkxhYmVsIGFuZCBnZW5MYWJlbDpJc0EoJ1RleHRMYWJlbCcpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIG1wcyA9IHBhcnNlTW9uZXlQZXJTZWMoZ2VuTGFiZWwuVGV4dCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBiZXN0UGV0SW5mbyBvciBtcHMgPiBiZXN0UGV0SW5mby5tcHMgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlc3RQZXRJbmZvID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXROYW1lID0gZGlzcGxheU5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdlblRleHQgPSBnZW5MYWJlbC5UZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtcHMgPSBtcHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsID0gcGFyZW50TW9kZWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCgogICAgaWYgZXNwQmVzdEFjdGl2ZSB0aGVuCiAgICAgICAgZm9yIF8sIHBsb3QgaW4gaXBhaXJzKHBsb3RzOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGZvciBfLCBpbnN0IGluIGlwYWlycyhwbG90OkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgICAgICBpZiBpbnN0OklzQSgnQmlsbGJvYXJkR3VpJykgYW5kIGluc3QuTmFtZSA9PSAnQmVzdF9FU1AnIHRoZW4KICAgICAgICAgICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIGluc3Q6RGVzdHJveSgpCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIGlmIGJlc3RQZXRJbmZvIGFuZCBiZXN0UGV0SW5mby5tcHMgPiAwIGFuZCBiZXN0UGV0SW5mby5tb2RlbCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGJpbGxib2FyZCA9IEluc3RhbmNlLm5ldygnQmlsbGJvYXJkR3VpJykKICAgICAgICAgICAgYmlsbGJvYXJkLk5hbWUgPSAnQmVzdF9FU1AnCiAgICAgICAgICAgIGJpbGxib2FyZC5TaXplID0gVURpbTIubmV3KDAsIDMwMywgMCwgNzUpCiAgICAgICAgICAgIGJpbGxib2FyZC5TdHVkc09mZnNldCA9IFZlY3RvcjMubmV3KDAsIDQuODQsIDApCiAgICAgICAgICAgIGJpbGxib2FyZC5BbHdheXNPblRvcCA9IHRydWUKICAgICAgICAgICAgYmlsbGJvYXJkLlBhcmVudCA9IGJlc3RQZXRJbmZvLm1vZGVsCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2NhbCBuYW1lTGFiZWwgPSBJbnN0YW5jZS5uZXcoJ1RleHRMYWJlbCcpCiAgICAgICAgICAgIG5hbWVMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDM1KQogICAgICAgICAgICBuYW1lTGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMCkKICAgICAgICAgICAgbmFtZUxhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIG5hbWVMYWJlbC5UZXh0ID0gYmVzdFBldEluZm8ucGV0TmFtZQogICAgICAgICAgICBuYW1lTGFiZWwuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMCwgNjApCiAgICAgICAgICAgIG5hbWVMYWJlbC5Gb250ID0gRW51bS5Gb250LkdvdGhhbVNlbWlib2xkCiAgICAgICAgICAgIG5hbWVMYWJlbC5UZXh0U2l6ZSA9IDI1CiAgICAgICAgICAgIG5hbWVMYWJlbC5UZXh0U3Ryb2tlVHJhbnNwYXJlbmN5ID0gMC4wNwogICAgICAgICAgICBuYW1lTGFiZWwuVGV4dFN0cm9rZUNvbG9yMyA9IENvbG9yMy5uZXcoMCwgMCwgMCkKICAgICAgICAgICAgbmFtZUxhYmVsLlBhcmVudCA9IGJpbGxib2FyZAogICAgICAgICAgICAKICAgICAgICAgICAgbG9jYWwgbW9uZXlMYWJlbCA9IEluc3RhbmNlLm5ldygnVGV4dExhYmVsJykKICAgICAgICAgICAgbW9uZXlMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDIyKQogICAgICAgICAgICBtb25leUxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDM1KQogICAgICAgICAgICBtb25leUxhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIG1vbmV5TGFiZWwuVGV4dCA9IGJlc3RQZXRJbmZvLmdlblRleHQKICAgICAgICAgICAgbW9uZXlMYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMjQwLCA2MCkKICAgICAgICAgICAgbW9uZXlMYWJlbC5Gb250ID0gRW51bS5Gb250LkdvdGhhbVNlbWlib2xkCiAgICAgICAgICAgIG1vbmV5TGFiZWwuVGV4dFNpemUgPSAyMgogICAgICAgICAgICBtb25leUxhYmVsLlRleHRTdHJva2VUcmFuc3BhcmVuY3kgPSAwLjE3CiAgICAgICAgICAgIG1vbmV5TGFiZWwuVGV4dFN0cm9rZUNvbG9yMyA9IENvbG9yMy5uZXcoMCwgMCwgMCkKICAgICAgICAgICAgbW9uZXlMYWJlbC5QYXJlbnQgPSBiaWxsYm9hcmQKCiAgICAgICAgICAgIHRhYmxlLmluc2VydChiZXN0RXNwT2JqZWN0cywgYmlsbGJvYXJkKQogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgYmVzdEVzcExvb3AKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlQmVzdEVTUCgpCiAgICBlc3BCZXN0QWN0aXZlID0gbm90IGVzcEJlc3RBY3RpdmUKICAgIAogICAgaWYgYmVzdEVzcExvb3AgdGhlbgogICAgICAgIGJlc3RFc3BMb29wOkRpc2Nvbm5lY3QoKQogICAgICAgIGJlc3RFc3BMb29wID0gbmlsCiAgICBlbmQKICAgIAogICAgaWYgZXNwQmVzdEFjdGl2ZSB0aGVuCiAgICAgICAgdXBkYXRlQmVzdEVTUCgpCiAgICAgICAgYmVzdEVzcExvb3AgPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgaWYgbm90IGVzcEJlc3RBY3RpdmUgdGhlbgogICAgICAgICAgICAgICAgYmVzdEVzcExvb3A6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBiZXN0RXNwTG9vcCA9IG5pbAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICB3YWl0KDIpCiAgICAgICAgICAgIHVwZGF0ZUJlc3RFU1AoKQogICAgICAgIGVuZCkKICAgIGVsc2UKICAgICAgICBjbGVhckJlc3RFU1AoKQogICAgZW5kCiAgICBzYXZlU2V0dGluZ3MoKQplbmQKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0gUExBWUVSIEVTUAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmxvY2FsIHBsYXllckVzcEFjdGl2ZSA9IGZhbHNlCmxvY2FsIHBsYXllckVzcEJveGVzID0ge30KCmxvY2FsIGZ1bmN0aW9uIGNsZWFyUGxheWVyRVNQKCkKICAgIGZvciBwbHIsIG9ianMgaW4gcGFpcnMocGxheWVyRXNwQm94ZXMpIGRvCiAgICAgICAgaWYgb2Jqcy5ib3ggdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBvYmpzLmJveDpEZXN0cm95KCkKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgICAgIGlmIG9ianMudGV4dCB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIG9ianMudGV4dDpEZXN0cm95KCkKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAogICAgZW5kCiAgICBwbGF5ZXJFc3BCb3hlcyA9IHt9CmVuZAoKbG9jYWwgZnVuY3Rpb24gdXBkYXRlUGxheWVyRVNQKCkKICAgIGlmIG5vdCBwbGF5ZXJFc3BBY3RpdmUgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIGZvciBfLCBwbHIgaW4gaXBhaXJzKFBsYXllcnM6R2V0UGxheWVycygpKSBkbwogICAgICAgIGlmIHBsciB+PSBwbGF5ZXIgYW5kIHBsci5DaGFyYWN0ZXIgYW5kIHBsci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoJ0h1bWFub2lkUm9vdFBhcnQnKSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGhycCA9IHBsci5DaGFyYWN0ZXIuSHVtYW5vaWRSb290UGFydAogICAgICAgICAgICBpZiBub3QgcGxheWVyRXNwQm94ZXNbcGxyXSB0aGVuCiAgICAgICAgICAgICAgICBwbGF5ZXJFc3BCb3hlc1twbHJdID0ge30KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9jYWwgYm94ID0gSW5zdGFuY2UubmV3KCdCb3hIYW5kbGVBZG9ybm1lbnQnKQogICAgICAgICAgICAgICAgYm94LlNpemUgPSBWZWN0b3IzLm5ldyg0LCA2LCA0KQogICAgICAgICAgICAgICAgYm94LkFkb3JuZWUgPSBocnAKICAgICAgICAgICAgICAgIGJveC5BbHdheXNPblRvcCA9IHRydWUKICAgICAgICAgICAgICAgIGJveC5aSW5kZXggPSAxMAogICAgICAgICAgICAgICAgYm94LlRyYW5zcGFyZW5jeSA9IDAuNQogICAgICAgICAgICAgICAgYm94LkNvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1MCwgMCwgNjApCiAgICAgICAgICAgICAgICBib3guUGFyZW50ID0gaHJwCiAgICAgICAgICAgICAgICBwbGF5ZXJFc3BCb3hlc1twbHJdLmJveCA9IGJveAoKICAgICAgICAgICAgICAgIGxvY2FsIGJpbGxib2FyZCA9IEluc3RhbmNlLm5ldygnQmlsbGJvYXJkR3VpJykKICAgICAgICAgICAgICAgIGJpbGxib2FyZC5BZG9ybmVlID0gaHJwCiAgICAgICAgICAgICAgICBiaWxsYm9hcmQuU2l6ZSA9IFVEaW0yLm5ldygwLCAyMDAsIDAsIDMwKQogICAgICAgICAgICAgICAgYmlsbGJvYXJkLlN0dWRzT2Zmc2V0ID0gVmVjdG9yMy5uZXcoMCwgNCwgMCkKICAgICAgICAgICAgICAgIGJpbGxib2FyZC5BbHdheXNPblRvcCA9IHRydWUKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9jYWwgbGFiZWwgPSBJbnN0YW5jZS5uZXcoJ1RleHRMYWJlbCcsIGJpbGxib2FyZCkKICAgICAgICAgICAgICAgIGxhYmVsLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCkKICAgICAgICAgICAgICAgIGxhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgICAgICBsYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjIwLCAwLCA2MCkKICAgICAgICAgICAgICAgIGxhYmVsLlRleHRTdHJva2VUcmFuc3BhcmVuY3kgPSAwCiAgICAgICAgICAgICAgICBsYWJlbC5UZXh0ID0gcGxyLk5hbWUKICAgICAgICAgICAgICAgIGxhYmVsLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAogICAgICAgICAgICAgICAgbGFiZWwuVGV4dFNpemUgPSAxOAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBwbGF5ZXJFc3BCb3hlc1twbHJdLnRleHQgPSBiaWxsYm9hcmQKICAgICAgICAgICAgICAgIGJpbGxib2FyZC5QYXJlbnQgPSBocnAKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgaWYgcGxheWVyRXNwQm94ZXNbcGxyXS5ib3ggdGhlbgogICAgICAgICAgICAgICAgICAgIHBsYXllckVzcEJveGVzW3Bscl0uYm94LkFkb3JuZWUgPSBocnAKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgaWYgcGxheWVyRXNwQm94ZXNbcGxyXS50ZXh0IHRoZW4KICAgICAgICAgICAgICAgICAgICBwbGF5ZXJFc3BCb3hlc1twbHJdLnRleHQuQWRvcm5lZSA9IGhycAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgcGxheWVyRXNwQm94ZXNbcGxyXSB0aGVuCiAgICAgICAgICAgICAgICBpZiBwbGF5ZXJFc3BCb3hlc1twbHJdLmJveCB0aGVuCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJFc3BCb3hlc1twbHJdLmJveDpEZXN0cm95KCkKICAgICAgICAgICAgICAgICAgICBlbmQpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGlmIHBsYXllckVzcEJveGVzW3Bscl0udGV4dCB0aGVuCiAgICAgICAgICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJFc3BCb3hlc1twbHJdLnRleHQ6RGVzdHJveSgpCiAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBwbGF5ZXJFc3BCb3hlc1twbHJdID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgcGxheWVyRXNwTG9vcApsb2NhbCBmdW5jdGlvbiB0b2dnbGVQbGF5ZXJFU1AoKQogICAgcGxheWVyRXNwQWN0aXZlID0gbm90IHBsYXllckVzcEFjdGl2ZQogICAgCiAgICBpZiBwbGF5ZXJFc3BMb29wIHRoZW4KICAgICAgICBwbGF5ZXJFc3BMb29wOkRpc2Nvbm5lY3QoKQogICAgICAgIHBsYXllckVzcExvb3AgPSBuaWwKICAgIGVuZAogICAgCiAgICBpZiBwbGF5ZXJFc3BBY3RpdmUgdGhlbgogICAgICAgIHVwZGF0ZVBsYXllckVTUCgpCiAgICAgICAgcGxheWVyRXNwTG9vcCA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBub3QgcGxheWVyRXNwQWN0aXZlIHRoZW4KICAgICAgICAgICAgICAgIHBsYXllckVzcExvb3A6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBwbGF5ZXJFc3BMb29wID0gbmlsCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIHVwZGF0ZVBsYXllckVTUCgpCiAgICAgICAgZW5kKQogICAgZWxzZQogICAgICAgIGNsZWFyUGxheWVyRVNQKCkKICAgIGVuZAogICAgc2F2ZVNldHRpbmdzKCkKZW5kCgpQbGF5ZXJzLlBsYXllclJlbW92aW5nOkNvbm5lY3QoZnVuY3Rpb24ocGxyKQogICAgbG9jYWwgb2JqcyA9IHBsYXllckVzcEJveGVzW3Bscl0KICAgIGlmIG9ianMgdGhlbgogICAgICAgIGlmIG9ianMuYm94IHRoZW4KICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgb2Jqcy5ib3g6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgICAgICBpZiBvYmpzLnRleHQgdGhlbgogICAgICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICBvYmpzLnRleHQ6RGVzdHJveSgpCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbmQKICAgICAgICBwbGF5ZXJFc3BCb3hlc1twbHJdID0gbmlsCiAgICBlbmQKZW5kKQoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQotLSBTVEVBTCBGTE9PUiAtIEF5csSxIEJ1dG9uIE9sYXJhawotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmxvY2FsIHN0ZWFsRmxvb3JBY3RpdmUgPSBmYWxzZQpsb2NhbCBzZkZsb2F0U3BlZWQgPSAyNApsb2NhbCBzZkF0dGFjaG1lbnQsIHNmQWxpZ25Qb3NpdGlvbiwgc2ZBbGlnbk9yaWVudGF0aW9uLCBzZkxpbmVhclZlbG9jaXR5CmxvY2FsIHNmSGVhcnRiZWF0Q29ubiwgc2ZQcm9tcHRDb25uLCBzZkRpZWRDb25uLCBzZkNoYXJBZGRlZENvbm4KbG9jYWwgc2ZPcmlnaW5hbFByb3BzID0ge30KCmxvY2FsIGZ1bmN0aW9uIHNmU2FmZURpc2Nvbm5lY3QoY29ubikKICAgIGlmIGNvbm4gYW5kIHR5cGVvZihjb25uKSA9PSAiUkJYU2NyaXB0Q29ubmVjdGlvbiIgdGhlbgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgY29ubjpEaXNjb25uZWN0KCkKICAgICAgICBlbmQpCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBzZlNldFBsb3RzVHJhbnNwYXJlbmN5KGFjdGl2ZSkKICAgIGxvY2FsIHBsb3RzID0gV29ya3NwYWNlOkZpbmRGaXJzdENoaWxkKCdQbG90cycpCiAgICBpZiBub3QgcGxvdHMgdGhlbiByZXR1cm4gZW5kCgogICAgaWYgYWN0aXZlIHRoZW4KICAgICAgICBzZk9yaWdpbmFsUHJvcHMgPSB7fQogICAgICAgIGZvciBfLCBwbG90IGluIGlwYWlycyhwbG90czpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBsb2NhbCBjb250YWluZXJzID0gewogICAgICAgICAgICAgICAgcGxvdDpGaW5kRmlyc3RDaGlsZCgnRGVjb3JhdGlvbnMnKSwKICAgICAgICAgICAgICAgIHBsb3Q6RmluZEZpcnN0Q2hpbGQoJ0FuaW1hbFBvZGl1bXMnKSwKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgXywgY29udGFpbmVyIGluIGlwYWlycyhjb250YWluZXJzKSBkbwogICAgICAgICAgICAgICAgaWYgY29udGFpbmVyIHRoZW4KICAgICAgICAgICAgICAgICAgICBmb3IgXywgb2JqIGluIGlwYWlycyhjb250YWluZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgb2JqOklzQSgnQmFzZVBhcnQnKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZk9yaWdpbmFsUHJvcHNbb2JqXSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUcmFuc3BhcmVuY3kgPSBvYmouVHJhbnNwYXJlbmN5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGVyaWFsID0gb2JqLk1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLlRyYW5zcGFyZW5jeSA9IDAuNwogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVsc2UKICAgICAgICBmb3IgcGFydCwgcHJvcHMgaW4gcGFpcnMoc2ZPcmlnaW5hbFByb3BzKSBkbwogICAgICAgICAgICBpZiBwYXJ0IGFuZCBwYXJ0LlBhcmVudCB0aGVuCiAgICAgICAgICAgICAgICBwYXJ0LlRyYW5zcGFyZW5jeSA9IHByb3BzLlRyYW5zcGFyZW5jeQogICAgICAgICAgICAgICAgcGFydC5NYXRlcmlhbCA9IHByb3BzLk1hdGVyaWFsCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIHNmT3JpZ2luYWxQcm9wcyA9IHt9CiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBzZkRlc3Ryb3lCb2RpZXMoKQogICAgaWYgc2ZMaW5lYXJWZWxvY2l0eSB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBzZkxpbmVhclZlbG9jaXR5OkRlc3Ryb3koKSBlbmQpCiAgICBlbmQKICAgIGlmIHNmQWxpZ25Qb3NpdGlvbiB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBzZkFsaWduUG9zaXRpb246RGVzdHJveSgpIGVuZCkKICAgIGVuZAogICAgaWYgc2ZBbGlnbk9yaWVudGF0aW9uIHRoZW4KICAgICAgICBwY2FsbChmdW5jdGlvbigpIHNmQWxpZ25PcmllbnRhdGlvbjpEZXN0cm95KCkgZW5kKQogICAgZW5kCiAgICBpZiBzZkF0dGFjaG1lbnQgdGhlbgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgc2ZBdHRhY2htZW50OkRlc3Ryb3koKSBlbmQpCiAgICBlbmQKICAgIHNmTGluZWFyVmVsb2NpdHksIHNmQWxpZ25Qb3NpdGlvbiwgc2ZBbGlnbk9yaWVudGF0aW9uLCBzZkF0dGFjaG1lbnQgPSBuaWwsIG5pbCwgbmlsLCBuaWwKZW5kCgpsb2NhbCBmdW5jdGlvbiBzZkNyZWF0ZUJvZGllcyhyb290UGFydCkKICAgIHNmRGVzdHJveUJvZGllcygpCiAgICBpZiBub3Qgcm9vdFBhcnQgdGhlbiByZXR1cm4gZW5kCgogICAgc2ZBdHRhY2htZW50ID0gSW5zdGFuY2UubmV3KCdBdHRhY2htZW50JykKICAgIHNmQXR0YWNobWVudC5OYW1lID0gJ1N0ZWFsRmxvb3JfQXR0YWNobWVudCcKICAgIHNmQXR0YWNobWVudC5QYXJlbnQgPSByb290UGFydAoKICAgIHNmQWxpZ25Qb3NpdGlvbiA9IEluc3RhbmNlLm5ldygnQWxpZ25Qb3NpdGlvbicpCiAgICBzZkFsaWduUG9zaXRpb24uTmFtZSA9ICdTdGVhbEZsb29yX0FsaWduUG9zaXRpb24nCiAgICBzZkFsaWduUG9zaXRpb24uQXR0YWNobWVudDAgPSBzZkF0dGFjaG1lbnQKICAgIHNmQWxpZ25Qb3NpdGlvbi5Nb2RlID0gRW51bS5Qb3NpdGlvbkFsaWdubWVudE1vZGUuT25lQXR0YWNobWVudAogICAgc2ZBbGlnblBvc2l0aW9uLlBvc2l0aW9uID0gcm9vdFBhcnQuUG9zaXRpb24KICAgIHNmQWxpZ25Qb3NpdGlvbi5NYXhGb3JjZSA9IDUwMDAwMAogICAgc2ZBbGlnblBvc2l0aW9uLlJlc3BvbnNpdmVuZXNzID0gMjAwCiAgICBzZkFsaWduUG9zaXRpb24uQXBwbHlBdENlbnRlck9mTWFzcyA9IHRydWUKICAgIHNmQWxpZ25Qb3NpdGlvbi5Gb3JjZUxpbWl0TW9kZSA9IEVudW0uRm9yY2VMaW1pdE1vZGUuUGVyQXhpcwogICAgc2ZBbGlnblBvc2l0aW9uLk1heEF4ZXNGb3JjZSA9IFZlY3RvcjMubmV3KG1hdGguaHVnZSwgMCwgbWF0aC5odWdlKQogICAgc2ZBbGlnblBvc2l0aW9uLlBhcmVudCA9IHJvb3RQYXJ0CgogICAgc2ZBbGlnbk9yaWVudGF0aW9uID0gSW5zdGFuY2UubmV3KCdBbGlnbk9yaWVudGF0aW9uJykKICAgIHNmQWxpZ25PcmllbnRhdGlvbi5OYW1lID0gJ1N0ZWFsRmxvb3JfQWxpZ25PcmllbnRhdGlvbicKICAgIHNmQWxpZ25PcmllbnRhdGlvbi5BdHRhY2htZW50MCA9IHNmQXR0YWNobWVudAogICAgc2ZBbGlnbk9yaWVudGF0aW9uLk1vZGUgPSBFbnVtLk9yaWVudGF0aW9uQWxpZ25tZW50TW9kZS5PbmVBdHRhY2htZW50CiAgICBzZkFsaWduT3JpZW50YXRpb24uQ0ZyYW1lID0gcm9vdFBhcnQuQ0ZyYW1lCiAgICBzZkFsaWduT3JpZW50YXRpb24uTWF4VG9ycXVlID0gNTAwMDAwCiAgICBzZkFsaWduT3JpZW50YXRpb24uUmVzcG9uc2l2ZW5lc3MgPSAyMDAKICAgIHNmQWxpZ25PcmllbnRhdGlvbi5QYXJlbnQgPSByb290UGFydAoKICAgIHNmTGluZWFyVmVsb2NpdHkgPSBJbnN0YW5jZS5uZXcoJ0xpbmVhclZlbG9jaXR5JykKICAgIHNmTGluZWFyVmVsb2NpdHkuTmFtZSA9ICdTdGVhbEZsb29yX0xpbmVhclZlbG9jaXR5JwogICAgc2ZMaW5lYXJWZWxvY2l0eS5BdHRhY2htZW50MCA9IHNmQXR0YWNobWVudAogICAgc2ZMaW5lYXJWZWxvY2l0eS5NYXhGb3JjZSA9IDUwMDAwMAogICAgc2ZMaW5lYXJWZWxvY2l0eS5Gb3JjZUxpbWl0TW9kZSA9IEVudW0uRm9yY2VMaW1pdE1vZGUuUGVyQXhpcwogICAgc2ZMaW5lYXJWZWxvY2l0eS5NYXhBeGVzRm9yY2UgPSBWZWN0b3IzLm5ldygwLCBtYXRoLmh1Z2UsIDApCiAgICBzZkxpbmVhclZlbG9jaXR5LlZlY3RvclZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwgMCwgMCkKICAgIHNmTGluZWFyVmVsb2NpdHkuUGFyZW50ID0gcm9vdFBhcnQKZW5kCgpsb2NhbCBmdW5jdGlvbiBzZlRlbGVwb3J0VG9Hcm91bmQoKQogICAgbG9jYWwgY2hhciA9IHBsYXllci5DaGFyYWN0ZXIKICAgIGxvY2FsIHJwID0gY2hhciBhbmQgY2hhcjpGaW5kRmlyc3RDaGlsZCgnSHVtYW5vaWRSb290UGFydCcpCiAgICBsb2NhbCBodW0gPSBjaGFyIGFuZCBjaGFyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygnSHVtYW5vaWQnKQogICAgaWYgbm90IChycCBhbmQgaHVtIGFuZCBodW0uSGVhbHRoID4gMCkgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgcmF5UGFyYW1zID0gUmF5Y2FzdFBhcmFtcy5uZXcoKQogICAgcmF5UGFyYW1zLkZpbHRlclR5cGUgPSBFbnVtLlJheWNhc3RGaWx0ZXJUeXBlLkV4Y2x1ZGUKICAgIHJheVBhcmFtcy5GaWx0ZXJEZXNjZW5kYW50c0luc3RhbmNlcyA9IHtjaGFyfQoKICAgIGxvY2FsIHJheVJlc3VsdCA9IFdvcmtzcGFjZTpSYXljYXN0KHJwLlBvc2l0aW9uLCBWZWN0b3IzLm5ldygwLCAtMTUwMCwgMCksIHJheVBhcmFtcykKICAgIGlmIHJheVJlc3VsdCB0aGVuCiAgICAgICAgcnAuQ0ZyYW1lID0gQ0ZyYW1lLm5ldygKICAgICAgICAgICAgcnAuUG9zaXRpb24uWCwKICAgICAgICAgICAgcmF5UmVzdWx0LlBvc2l0aW9uLlkgKyBodW0uSGlwSGVpZ2h0LAogICAgICAgICAgICBycC5Qb3NpdGlvbi5aCiAgICAgICAgKQogICAgICAgIGlmIHN0ZWFsRmxvb3JBY3RpdmUgdGhlbgogICAgICAgICAgICB0b2dnbGVTdGVhbEZsb29yKCkKICAgICAgICBlbmQKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHNmRW5hYmxlKCkKICAgIGlmIHN0ZWFsRmxvb3JBY3RpdmUgdGhlbiByZXR1cm4gZW5kCiAgICBsb2NhbCBodW0gPSBwbGF5ZXIuQ2hhcmFjdGVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygnSHVtYW5vaWQnKQogICAgbG9jYWwgcm9vdCA9IHBsYXllci5DaGFyYWN0ZXIgYW5kIHBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoJ0h1bWFub2lkUm9vdFBhcnQnKQogICAgaWYgbm90IChodW0gYW5kIGh1bS5IZWFsdGggPiAwIGFuZCByb290KSB0aGVuIHJldHVybiBlbmQKCiAgICBzdGVhbEZsb29yQWN0aXZlID0gdHJ1ZQogICAgc2ZDcmVhdGVCb2RpZXMocm9vdCkKICAgIHNmU2V0UGxvdHNUcmFuc3BhcmVuY3kodHJ1ZSkKCiAgICBzZlNhZmVEaXNjb25uZWN0KHNmSGVhcnRiZWF0Q29ubikKICAgIHNmSGVhcnRiZWF0Q29ubiA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIG5vdCBzdGVhbEZsb29yQWN0aXZlIG9yIG5vdCBzZkxpbmVhclZlbG9jaXR5IHRoZW4gcmV0dXJuIGVuZAogICAgICAgIGxvY2FsIGggPSBwbGF5ZXIuQ2hhcmFjdGVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygnSHVtYW5vaWQnKQogICAgICAgIGlmIG5vdCAoaCBhbmQgaC5IZWFsdGggPiAwKSB0aGVuCiAgICAgICAgICAgIHRvZ2dsZVN0ZWFsRmxvb3IoKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICBzZkxpbmVhclZlbG9jaXR5LlZlY3RvclZlbG9jaXR5ID0gVmVjdG9yMy5uZXcoMCwgc2ZGbG9hdFNwZWVkLCAwKQogICAgZW5kKQoKICAgIHNmU2FmZURpc2Nvbm5lY3Qoc2ZQcm9tcHRDb25uKQogICAgc2ZQcm9tcHRDb25uID0gUHJveGltaXR5UHJvbXB0U2VydmljZS5Qcm9tcHRUcmlnZ2VyZWQ6Q29ubmVjdChmdW5jdGlvbihwcm9tcHQsIHdobykKICAgICAgICBpZiB3aG8gPT0gcGxheWVyIHRoZW4KICAgICAgICAgICAgbG9jYWwgYWN0ID0gKHByb21wdC5BY3Rpb25UZXh0IG9yICcnKTpsb3dlcigpCiAgICAgICAgICAgIGlmIHN0cmluZy5maW5kKGFjdCwgJ3N0ZWFsJykgdGhlbgogICAgICAgICAgICAgICAgc2ZUZWxlcG9ydFRvR3JvdW5kKCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgc2ZTYWZlRGlzY29ubmVjdChzZkRpZWRDb25uKQogICAgaWYgaHVtIHRoZW4KICAgICAgICBzZkRpZWRDb25uID0gaHVtLkRpZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgIHRvZ2dsZVN0ZWFsRmxvb3IoKQogICAgICAgIGVuZCkKICAgIGVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIHNmRGlzYWJsZSgpCiAgICBpZiBub3Qgc3RlYWxGbG9vckFjdGl2ZSB0aGVuCiAgICAgICAgc2ZTZXRQbG90c1RyYW5zcGFyZW5jeShmYWxzZSkKICAgICAgICBzZkRlc3Ryb3lCb2RpZXMoKQogICAgICAgIHNmU2FmZURpc2Nvbm5lY3Qoc2ZIZWFydGJlYXRDb25uKQogICAgICAgIHNmU2FmZURpc2Nvbm5lY3Qoc2ZQcm9tcHRDb25uKQogICAgICAgIHNmU2FmZURpc2Nvbm5lY3Qoc2ZEaWVkQ29ubikKICAgICAgICBzZkhlYXJ0YmVhdENvbm4sIHNmUHJvbXB0Q29ubiwgc2ZEaWVkQ29ubiA9IG5pbCwgbmlsLCBuaWwKICAgICAgICByZXR1cm4KICAgIGVuZAogICAgc3RlYWxGbG9vckFjdGl2ZSA9IGZhbHNlCiAgICBzZlNldFBsb3RzVHJhbnNwYXJlbmN5KGZhbHNlKQogICAgc2ZEZXN0cm95Qm9kaWVzKCkKICAgIHNmU2FmZURpc2Nvbm5lY3Qoc2ZIZWFydGJlYXRDb25uKQogICAgc2ZTYWZlRGlzY29ubmVjdChzZlByb21wdENvbm4pCiAgICBzZlNhZmVEaXNjb25uZWN0KHNmRGllZENvbm4pCiAgICBzZkhlYXJ0YmVhdENvbm4sIHNmUHJvbXB0Q29ubiwgc2ZEaWVkQ29ubiA9IG5pbCwgbmlsLCBuaWwKZW5kCgpsb2NhbCBmdW5jdGlvbiB0b2dnbGVTdGVhbEZsb29yKCkKICAgIGlmIG5vdCBzdGVhbEZsb29yQWN0aXZlIHRoZW4KICAgICAgICBzZkVuYWJsZSgpCiAgICBlbHNlCiAgICAgICAgc2ZEaXNhYmxlKCkKICAgIGVuZAogICAgc2F2ZVNldHRpbmdzKCkKZW5kCgpzZlNhZmVEaXNjb25uZWN0KHNmQ2hhckFkZGVkQ29ubikKc2ZDaGFyQWRkZWRDb25uID0gcGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oY2gpCiAgICB0YXNrLndhaXQoMC4xKQogICAgc2ZEaXNhYmxlKCkKZW5kKQoKLS0gU3RlYWwgRmxvb3IgQnV0b251IChTb2wgQWx0IEvDtsWfZSkKbG9jYWwgc3RlYWxGbG9vckd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKc3RlYWxGbG9vckd1aS5OYW1lID0gIlN0ZWFsRmxvb3JCdXR0b24iCnN0ZWFsRmxvb3JHdWkuUmVzZXRPblNwYXduID0gZmFsc2UKc3RlYWxGbG9vckd1aS5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuU2libGluZwpzdGVhbEZsb29yR3VpLlBhcmVudCA9IENvcmVHdWkKCmxvY2FsIHN0ZWFsRmxvb3JCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQpzdGVhbEZsb29yQnV0dG9uLk5hbWUgPSAiU3RlYWxGbG9vciIKc3RlYWxGbG9vckJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAsIDEyMCwgMCwgNTApCnN0ZWFsRmxvb3JCdXR0b24uUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTAsIDEsIC02MCkgLS0gU29sIEFsdCBLw7bFn2UKc3RlYWxGbG9vckJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMjAsIDEyMCkKc3RlYWxGbG9vckJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC40CnN0ZWFsRmxvb3JCdXR0b24uVGV4dCA9ICLwn4+X77iPIFN0ZWFsIEZsb29yIgpzdGVhbEZsb29yQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAwKQpzdGVhbEZsb29yQnV0dG9uLlRleHRTaXplID0gMTQKc3RlYWxGbG9vckJ1dHRvbi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKc3RlYWxGbG9vckJ1dHRvbi5UZXh0V3JhcHBlZCA9IHRydWUKc3RlYWxGbG9vckJ1dHRvbi5EcmFnZ2FibGUgPSB0cnVlCnN0ZWFsRmxvb3JCdXR0b24uUGFyZW50ID0gc3RlYWxGbG9vckd1aQoKbG9jYWwgc3RlYWxGbG9vckNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpzdGVhbEZsb29yQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDEyKQpzdGVhbEZsb29yQ29ybmVyLlBhcmVudCA9IHN0ZWFsRmxvb3JCdXR0b24KCmxvY2FsIHN0ZWFsRmxvb3JTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikKc3RlYWxGbG9vclN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjAwLCAyMDApCnN0ZWFsRmxvb3JTdHJva2UuVGhpY2tuZXNzID0gMgpzdGVhbEZsb29yU3Ryb2tlLlRyYW5zcGFyZW5jeSA9IDAuMwpzdGVhbEZsb29yU3Ryb2tlLlBhcmVudCA9IHN0ZWFsRmxvb3JCdXR0b24KCnN0ZWFsRmxvb3JCdXR0b24uTW91c2VFbnRlcjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoc3RlYWxGbG9vckJ1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjIpLCB7CiAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMiwKICAgICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIH0pOlBsYXkoKQplbmQpCgpzdGVhbEZsb29yQnV0dG9uLk1vdXNlTGVhdmU6Q29ubmVjdChmdW5jdGlvbigpCiAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKHN0ZWFsRmxvb3JCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgewogICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjQsCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCiAgICB9KTpQbGF5KCkKZW5kKQoKc3RlYWxGbG9vckJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIHRvZ2dsZVN0ZWFsRmxvb3IoKQogICAgaWYgc3RlYWxGbG9vckFjdGl2ZSB0aGVuCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShzdGVhbEZsb29yQnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMyksIHsKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEyMCwgMjU1LCAxMjApCiAgICAgICAgfSk6UGxheSgpCiAgICAgICAgc3RlYWxGbG9vckJ1dHRvbi5UZXh0ID0gIuKchSBTdGVhbCBGbG9vciIKICAgIGVsc2UKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKHN0ZWFsRmxvb3JCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4zKSwgewogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAxMjAsIDEyMCkKICAgICAgICB9KTpQbGF5KCkKICAgICAgICBzdGVhbEZsb29yQnV0dG9uLlRleHQgPSAi8J+Pl++4jyBTdGVhbCBGbG9vciIKICAgIGVuZAplbmQpCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi0tIERFWVNOQyBTWVNURU0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpsb2NhbCBhbnRpSGl0QWN0aXZlID0gZmFsc2UKbG9jYWwgY2xvbmVyQWN0aXZlID0gZmFsc2UKbG9jYWwgZGVzeW5jUnVubmluZyA9IGZhbHNlCmxvY2FsIGNsb25lTGlzdGVuZXJDb25uCmxvY2FsIGFudGlIaXRSdW5uaW5nID0gZmFsc2UKbG9jYWwgbG9ja2Rvd25SdW5uaW5nID0gZmFsc2UKbG9jYWwgbG9ja2Rvd25Db25uID0gbmlsCmxvY2FsIGludkhlYWx0aENvbm5zID0ge30KbG9jYWwgZGVzeW5jSGlnaGxpZ2h0cyA9IHt9CmxvY2FsIGNoYXJhY3RlckhpZ2hsaWdodHMgPSB7fQoKbG9jYWwgZnVuY3Rpb24gc2FmZURpc2Nvbm5lY3RDb25uKGNvbm4pCiAgICBpZiBjb25uIGFuZCB0eXBlb2YoY29ubikgPT0gIlJCWFNjcmlwdENvbm5lY3Rpb24iIHRoZW4KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGNvbm46RGlzY29ubmVjdCgpCiAgICAgICAgZW5kKQogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gYWRkQ2hhcmFjdGVySGlnaGxpZ2h0KGNoYXJhY3RlcikKICAgIGlmIG5vdCBjaGFyYWN0ZXIgb3IgY2hhcmFjdGVySGlnaGxpZ2h0c1tjaGFyYWN0ZXJdIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICBsb2NhbCBoaWdobGlnaHQgPSBJbnN0YW5jZS5uZXcoIkhpZ2hsaWdodCIpCiAgICBoaWdobGlnaHQuTmFtZSA9ICJEZXN5bmNDaGFyYWN0ZXJIaWdobGlnaHQiCiAgICBoaWdobGlnaHQuRmlsbENvbG9yID0gQ29sb3IzLmZyb21SR0IoMCwgMjU1LCAxMDApCiAgICBoaWdobGlnaHQuT3V0bGluZUNvbG9yID0gQ29sb3IzLmZyb21SR0IoMCwgMjAwLCA4MCkKICAgIGhpZ2hsaWdodC5GaWxsVHJhbnNwYXJlbmN5ID0gMC4zCiAgICBoaWdobGlnaHQuT3V0bGluZVRyYW5zcGFyZW5jeSA9IDAKICAgIGhpZ2hsaWdodC5EZXB0aE1vZGUgPSBFbnVtLkhpZ2hsaWdodERlcHRoTW9kZS5BbHdheXNPblRvcAogICAgaGlnaGxpZ2h0LlBhcmVudCA9IGNoYXJhY3RlcgogICAgCiAgICBjaGFyYWN0ZXJIaWdobGlnaHRzW2NoYXJhY3Rlcl0gPSBoaWdobGlnaHQKZW5kCgpsb2NhbCBmdW5jdGlvbiByZW1vdmVDaGFyYWN0ZXJIaWdobGlnaHQoY2hhcmFjdGVyKQogICAgbG9jYWwgaGlnaGxpZ2h0ID0gY2hhcmFjdGVySGlnaGxpZ2h0c1tjaGFyYWN0ZXJdCiAgICBpZiBoaWdobGlnaHQgdGhlbgogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgCiAgICAgICAgICAgIGhpZ2hsaWdodDpEZXN0cm95KCkgCiAgICAgICAgZW5kKQogICAgICAgIGNoYXJhY3RlckhpZ2hsaWdodHNbY2hhcmFjdGVyXSA9IG5pbAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gcmVtb3ZlQWxsSGlnaGxpZ2h0cygpCiAgICBmb3IgY2hhcmFjdGVyLCBoaWdobGlnaHQgaW4gcGFpcnMoY2hhcmFjdGVySGlnaGxpZ2h0cykgZG8KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGhpZ2hsaWdodDpEZXN0cm95KCkKICAgICAgICBlbmQpCiAgICBlbmQKICAgIGNoYXJhY3RlckhpZ2hsaWdodHMgPSB7fQplbmQKCmxvY2FsIGZ1bmN0aW9uIGFkZERlc3luY0hpZ2hsaWdodChtb2RlbCkKICAgIGlmIG5vdCBtb2RlbCBvciBkZXN5bmNIaWdobGlnaHRzW21vZGVsXSB0aGVuIHJldHVybiBlbmQKICAgIGxvY2FsIGhpZ2hsaWdodCA9IEluc3RhbmNlLm5ldygiSGlnaGxpZ2h0IikKICAgIGhpZ2hsaWdodC5OYW1lID0gIkRlc3luY0hpZ2hsaWdodCIKICAgIGhpZ2hsaWdodC5GaWxsQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDEwMCkKICAgIGhpZ2hsaWdodC5PdXRsaW5lQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDUwLCA1MCkKICAgIGhpZ2hsaWdodC5GaWxsVHJhbnNwYXJlbmN5ID0gMC41CiAgICBoaWdobGlnaHQuT3V0bGluZVRyYW5zcGFyZW5jeSA9IDAKICAgIGhpZ2hsaWdodC5QYXJlbnQgPSBtb2RlbAogICAgZGVzeW5jSGlnaGxpZ2h0c1ttb2RlbF0gPSBoaWdobGlnaHQKZW5kCgpsb2NhbCBmdW5jdGlvbiByZW1vdmVEZXN5bmNIaWdobGlnaHQobW9kZWwpCiAgICBsb2NhbCBobCA9IGRlc3luY0hpZ2hsaWdodHNbbW9kZWxdCiAgICBpZiBobCB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKSBobDpEZXN0cm95KCkgZW5kKQogICAgICAgIGRlc3luY0hpZ2hsaWdodHNbbW9kZWxdID0gbmlsCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBtYWtlSW52dWxuZXJhYmxlKG1vZGVsKQogICAgaWYgbm90IG1vZGVsIG9yIG5vdCBtb2RlbC5QYXJlbnQgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIGxvY2FsIGh1bSA9IG1vZGVsOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgaWYgbm90IGh1bSB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBtYXhIZWFsdGggPSAxZTkKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBodW0uTWF4SGVhbHRoID0gbWF4SGVhbHRoCiAgICAgICAgaHVtLkhlYWx0aCA9IG1heEhlYWx0aAogICAgZW5kKQoKICAgIGlmIGludkhlYWx0aENvbm5zW21vZGVsXSB0aGVuCiAgICAgICAgc2FmZURpc2Nvbm5lY3RDb25uKGludkhlYWx0aENvbm5zW21vZGVsXSkKICAgICAgICBpbnZIZWFsdGhDb25uc1ttb2RlbF0gPSBuaWwKICAgIGVuZAogICAgCiAgICBpbnZIZWFsdGhDb25uc1ttb2RlbF0gPSBodW0uSGVhbHRoQ2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGlmIGh1bS5IZWFsdGggPCBodW0uTWF4SGVhbHRoIHRoZW4KICAgICAgICAgICAgICAgIGh1bS5IZWFsdGggPSBodW0uTWF4SGVhbHRoCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZCkKCiAgICBpZiBub3QgbW9kZWw6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJGb3JjZUZpZWxkIikgdGhlbgogICAgICAgIGxvY2FsIGZmID0gSW5zdGFuY2UubmV3KCJGb3JjZUZpZWxkIikKICAgICAgICBmZi5WaXNpYmxlID0gZmFsc2UKICAgICAgICBmZi5QYXJlbnQgPSBtb2RlbAogICAgZW5kCgogICAgYWRkRGVzeW5jSGlnaGxpZ2h0KG1vZGVsKQogICAgYWRkQ2hhcmFjdGVySGlnaGxpZ2h0KG1vZGVsKQoKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBodW06U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuRGVhZCwgZmFsc2UpCiAgICAgICAgaHVtOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlBoeXNpY3MsIGZhbHNlKQogICAgZW5kKQplbmQKCmxvY2FsIGZ1bmN0aW9uIHJlbW92ZUludnVsbmVyYWJsZShtb2RlbCkKICAgIGlmIG5vdCBtb2RlbCB0aGVuIHJldHVybiBlbmQKICAgIAogICAgaWYgaW52SGVhbHRoQ29ubnNbbW9kZWxdIHRoZW4KICAgICAgICBzYWZlRGlzY29ubmVjdENvbm4oaW52SGVhbHRoQ29ubnNbbW9kZWxdKQogICAgICAgIGludkhlYWx0aENvbm5zW21vZGVsXSA9IG5pbAogICAgZW5kCiAgICAKICAgIGZvciBfLCBmZiBpbiBpcGFpcnMobW9kZWw6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBmZjpJc0EoIkZvcmNlRmllbGQiKSB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgZmY6RGVzdHJveSgpIGVuZCkKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICBsb2NhbCBodW0gPSBtb2RlbDpGaW5kRmlyc3RDaGlsZE9mQ2xhc3MoIkh1bWFub2lkIikKICAgIGlmIGh1bSB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBodW06U2V0U3RhdGVFbmFibGVkKEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuRGVhZCwgdHJ1ZSkKICAgICAgICAgICAgaHVtOlNldFN0YXRlRW5hYmxlZChFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlBoeXNpY3MsIHRydWUpCiAgICAgICAgICAgIGxvY2FsIHNhZmVNYXggPSAxMDAKICAgICAgICAgICAgaHVtLk1heEhlYWx0aCA9IHNhZmVNYXgKICAgICAgICAgICAgaWYgaHVtLkhlYWx0aCA+IHNhZmVNYXggdGhlbiBodW0uSGVhbHRoID0gc2FmZU1heCBlbmQKICAgICAgICBlbmQpCiAgICBlbmQKICAgIAogICAgcmVtb3ZlRGVzeW5jSGlnaGxpZ2h0KG1vZGVsKQogICAgcmVtb3ZlQ2hhcmFjdGVySGlnaGxpZ2h0KG1vZGVsKQplbmQKCmxvY2FsIGZ1bmN0aW9uIHRyeVNldEZsYWcoKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGlmIHNldGZmbGFnIHRoZW4gc2V0ZmZsYWcoIldvcmxkU3RlcE1heCIsICItOTk5OTk5OTk5OTk5OTkiKSBlbmQKICAgIGVuZCkKZW5kCgpsb2NhbCBmdW5jdGlvbiByZXNldEZsYWcoKQogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGlmIHNldGZmbGFnIHRoZW4gc2V0ZmZsYWcoIldvcmxkU3RlcE1heCIsICIxIikgZW5kCiAgICBlbmQpCmVuZAoKbG9jYWwgZnVuY3Rpb24gYWN0aXZhdGVEZXN5bmMoKQogICAgaWYgZGVzeW5jUnVubmluZyB0aGVuIHJldHVybiBlbmQKICAgIGRlc3luY1J1bm5pbmcgPSB0cnVlCiAgICB0cnlTZXRGbGFnKCkKZW5kCgpsb2NhbCBmdW5jdGlvbiBkZWFjdGl2YXRlRGVzeW5jKCkKICAgIGlmIG5vdCBkZXN5bmNSdW5uaW5nIHRoZW4gcmV0dXJuIGVuZAogICAgZGVzeW5jUnVubmluZyA9IGZhbHNlCiAgICByZXNldEZsYWcoKQplbmQKCmxvY2FsIGZ1bmN0aW9uIHBlcmZvcm1EZXN5bmNMb2NrZG93bihkdXJhdGlvbiwgb25Db21wbGV0ZSkKICAgIGlmIGxvY2tkb3duUnVubmluZyB0aGVuCiAgICAgICAgaWYgb25Db21wbGV0ZSB0aGVuIHBjYWxsKG9uQ29tcGxldGUpIGVuZAogICAgICAgIHJldHVybgogICAgZW5kCiAgICBsb2NrZG93blJ1bm5pbmcgPSB0cnVlCgogICAgbG9jYWwgY2hhciA9IHBsYXllci5DaGFyYWN0ZXIKICAgIGlmIG5vdCBjaGFyIHRoZW4KICAgICAgICBsb2NrZG93blJ1bm5pbmcgPSBmYWxzZQogICAgICAgIGlmIG9uQ29tcGxldGUgdGhlbiBwY2FsbChvbkNvbXBsZXRlKSBlbmQKICAgICAgICByZXR1cm4KICAgIGVuZAogICAgCiAgICBsb2NhbCBocnAgPSBjaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikKICAgIGxvY2FsIGh1bSA9IGNoYXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJIdW1hbm9pZCIpCiAgICBpZiBub3QgaHJwIG9yIG5vdCBodW0gdGhlbgogICAgICAgIGxvY2tkb3duUnVubmluZyA9IGZhbHNlCiAgICAgICAgaWYgb25Db21wbGV0ZSB0aGVuIHBjYWxsKG9uQ29tcGxldGUpIGVuZAogICAgICAgIHJldHVybgogICAgZW5kCgogICAgbG9jYWwgc2F2ZWRXYWxrID0gaHVtLldhbGtTcGVlZAogICAgbG9jYWwgc2F2ZWRKdW1wID0gaHVtLkp1bXBQb3dlcgogICAgbG9jYWwgc2F2ZWRVc2VKdW1wUG93ZXIgPSBodW0uVXNlSnVtcFBvd2VyCgogICAgaHVtLldhbGtTcGVlZCA9IDAKICAgIGh1bS5KdW1wUG93ZXIgPSAwCiAgICBodW0uVXNlSnVtcFBvd2VyID0gdHJ1ZQogICAgaHVtLlBsYXRmb3JtU3RhbmQgPSB0cnVlCgogICAgbG9jYWwgZml4ZWRDRnJhbWUgPSBocnAuQ0ZyYW1lCgogICAgaWYgbG9ja2Rvd25Db25uIHRoZW4KICAgICAgICBsb2NrZG93bkNvbm46RGlzY29ubmVjdCgpCiAgICAgICAgbG9ja2Rvd25Db25uID0gbmlsCiAgICBlbmQKCiAgICBsb2NhbCBsYXN0Q0ZyYW1lVGltZSA9IDAKICAgIGxvY2FsIENGUkFNRV9VUERBVEVfSU5URVJWQUwgPSAwLjE1CiAgICBsb2NrZG93bkNvbm4gPSBSdW5TZXJ2aWNlLkhlYXJ0YmVhdDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBpZiBub3QgaHJwIG9yIG5vdCBwbGF5ZXIuQ2hhcmFjdGVyIG9yIG5vdCBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZFJvb3RQYXJ0IikgdGhlbgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICBsb2NhbCBub3cgPSB0aWNrKCkKICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIGhycC5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApCiAgICAgICAgICAgIGhycC5Sb3RWZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApCiAgICAgICAgICAgIGlmIChub3cgLSBsYXN0Q0ZyYW1lVGltZSkgPj0gQ0ZSQU1FX1VQREFURV9JTlRFUlZBTCB0aGVuCiAgICAgICAgICAgICAgICBocnAuQ0ZyYW1lID0gZml4ZWRDRnJhbWUKICAgICAgICAgICAgICAgIGxhc3RDRnJhbWVUaW1lID0gbm93CiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZCkKCiAgICB0YXNrLmRlbGF5KGR1cmF0aW9uLCBmdW5jdGlvbigpCiAgICAgICAgaWYgbG9ja2Rvd25Db25uIHRoZW4KICAgICAgICAgICAgbG9ja2Rvd25Db25uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICBsb2NrZG93bkNvbm4gPSBuaWwKICAgICAgICBlbmQKCiAgICAgICAgaWYgaHVtIGFuZCBodW0uUGFyZW50IHRoZW4KICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgaHVtLldhbGtTcGVlZCA9IHNhdmVkV2FsayBvciAxNgogICAgICAgICAgICAgICAgaHVtLkp1bXBQb3dlciA9IHNhdmVkSnVtcCBvciA1MAogICAgICAgICAgICAgICAgaHVtLlVzZUp1bXBQb3dlciA9IHNhdmVkVXNlSnVtcFBvd2VyIG9yIHRydWUKICAgICAgICAgICAgICAgIGh1bS5QbGF0Zm9ybVN0YW5kID0gZmFsc2UKICAgICAgICAgICAgZW5kKQogICAgICAgIGVuZAoKICAgICAgICBsb2NrZG93blJ1bm5pbmcgPSBmYWxzZQogICAgICAgIGlmIG9uQ29tcGxldGUgdGhlbiBwY2FsbChvbkNvbXBsZXRlKSBlbmQKICAgIGVuZCkKZW5kCgpsb2NhbCBmdW5jdGlvbiBhY3RpdmF0ZUNsb25lckRlc3luYyhjYWxsYmFjaykKICAgIGlmIGNsb25lckFjdGl2ZSB0aGVuCiAgICAgICAgaWYgY2FsbGJhY2sgdGhlbiBjYWxsYmFjaygpIGVuZAogICAgICAgIHJldHVybgogICAgZW5kCiAgICBjbG9uZXJBY3RpdmUgPSB0cnVlCgogICAgbG9jYWwgQmFja3BhY2sgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGRPZkNsYXNzKCJCYWNrcGFjayIpCiAgICBsb2NhbCBmdW5jdGlvbiBlcXVpcFF1YW50dW1DbG9uZXIoKQogICAgICAgIGlmIG5vdCBCYWNrcGFjayB0aGVuIHJldHVybiBlbmQKICAgICAgICBsb2NhbCB0b29sID0gQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoIlF1YW50dW0gQ2xvbmVyIikKICAgICAgICBpZiB0b29sIHRoZW4KICAgICAgICAgICAgbG9jYWwgaHVtYW5vaWQgPSBwbGF5ZXIuQ2hhcmFjdGVyIGFuZCBwbGF5ZXIuQ2hhcmFjdGVyOkZpbmRGaXJzdENoaWxkT2ZDbGFzcygiSHVtYW5vaWQiKQogICAgICAgICAgICBpZiBodW1hbm9pZCB0aGVuIAogICAgICAgICAgICAgICAgaHVtYW5vaWQ6RXF1aXBUb29sKHRvb2wpCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoMC41KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgZXF1aXBRdWFudHVtQ2xvbmVyKCkKCiAgICBsb2NhbCBSRVVzZUl0ZW0gPSBSZXBsaWNhdGVkU3RvcmFnZS5QYWNrYWdlcy5OZXQ6RmluZEZpcnN0Q2hpbGQoIlJFL1VzZUl0ZW0iKQogICAgaWYgUkVVc2VJdGVtIHRoZW4gCiAgICAgICAgUkVVc2VJdGVtOkZpcmVTZXJ2ZXIoKQogICAgZW5kCiAgICAKICAgIGxvY2FsIFJFUXVhbnR1bUNsb25lck9uVGVsZXBvcnQgPSBSZXBsaWNhdGVkU3RvcmFnZS5QYWNrYWdlcy5OZXQ6RmluZEZpcnN0Q2hpbGQoIlJFL1F1YW50dW1DbG9uZXIvT25UZWxlcG9ydCIpCiAgICBpZiBSRVF1YW50dW1DbG9uZXJPblRlbGVwb3J0IHRoZW4gCiAgICAgICAgUkVRdWFudHVtQ2xvbmVyT25UZWxlcG9ydDpGaXJlU2VydmVyKCkKICAgIGVuZAoKICAgIGxvY2FsIGNsb25lTmFtZSA9IHRvc3RyaW5nKHBsYXllci5Vc2VySWQpIC4uICJfQ2xvbmUiCiAgICBjbG9uZUxpc3RlbmVyQ29ubiA9IFdvcmtzcGFjZS5DaGlsZEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24ob2JqKQogICAgICAgIGlmIG9iai5OYW1lID09IGNsb25lTmFtZSBhbmQgb2JqOklzQSgiTW9kZWwiKSB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgbWFrZUludnVsbmVyYWJsZShvYmopIGVuZCkKICAgICAgICAgICAgbG9jYWwgb3JpZ0NoYXIgPSBwbGF5ZXIuQ2hhcmFjdGVyCiAgICAgICAgICAgIGlmIG9yaWdDaGFyIHRoZW4gcGNhbGwoZnVuY3Rpb24oKSBtYWtlSW52dWxuZXJhYmxlKG9yaWdDaGFyKSBlbmQpIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgY2xvbmVMaXN0ZW5lckNvbm4gdGhlbgogICAgICAgICAgICAgICAgY2xvbmVMaXN0ZW5lckNvbm46RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBjbG9uZUxpc3RlbmVyQ29ubiA9IG5pbAogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHBlcmZvcm1EZXN5bmNMb2NrZG93bigxLjYsIGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIGlmIGNhbGxiYWNrIHRoZW4gcGNhbGwoY2FsbGJhY2spIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgdGFzay5kZWxheSg1LCBmdW5jdGlvbigpCiAgICAgICAgaWYgY2xvbmVMaXN0ZW5lckNvbm4gdGhlbgogICAgICAgICAgICBjbG9uZUxpc3RlbmVyQ29ubjpEaXNjb25uZWN0KCkKICAgICAgICAgICAgY2xvbmVMaXN0ZW5lckNvbm4gPSBuaWwKICAgICAgICBlbmQKICAgICAgICBjbG9uZXJBY3RpdmUgPSBmYWxzZQogICAgZW5kKQplbmQKCmxvY2FsIGZ1bmN0aW9uIGRlYWN0aXZhdGVDbG9uZXJEZXN5bmMoKQogICAgaWYgbm90IGNsb25lckFjdGl2ZSB0aGVuCiAgICAgICAgbG9jYWwgZXhpc3RpbmdDbG9uZSA9IFdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCh0b3N0cmluZyhwbGF5ZXIuVXNlcklkKSAuLiAiX0Nsb25lIikKICAgICAgICBpZiBleGlzdGluZ0Nsb25lIHRoZW4KICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgcmVtb3ZlSW52dWxuZXJhYmxlKGV4aXN0aW5nQ2xvbmUpCiAgICAgICAgICAgICAgICBleGlzdGluZ0Nsb25lOkRlc3Ryb3koKQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICAgICAgY2xvbmVyQWN0aXZlID0gZmFsc2UKICAgICAgICByZXR1cm4KICAgIGVuZAoKICAgIGNsb25lckFjdGl2ZSA9IGZhbHNlCiAgICBsb2NhbCBjaGFyID0gcGxheWVyLkNoYXJhY3RlcgogICAgaWYgY2hhciB0aGVuIHJlbW92ZUludnVsbmVyYWJsZShjaGFyKSBlbmQKICAgIAogICAgbG9jYWwgY2xvbmUgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQodG9zdHJpbmcocGxheWVyLlVzZXJJZCkgLi4gIl9DbG9uZSIpCiAgICBpZiBjbG9uZSB0aGVuCiAgICAgICAgcmVtb3ZlSW52dWxuZXJhYmxlKGNsb25lKQogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkgY2xvbmU6RGVzdHJveSgpIGVuZCkKICAgIGVuZAoKICAgIGlmIGNsb25lTGlzdGVuZXJDb25uIHRoZW4KICAgICAgICBjbG9uZUxpc3RlbmVyQ29ubjpEaXNjb25uZWN0KCkKICAgICAgICBjbG9uZUxpc3RlbmVyQ29ubiA9IG5pbAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gZXhlY3V0ZUFkdmFuY2VkRGVzeW5jKCkKICAgIGlmIGFudGlIaXRSdW5uaW5nIHRoZW4gCiAgICAgICAgcmV0dXJuIAogICAgZW5kCiAgICBhbnRpSGl0UnVubmluZyA9IHRydWUKCiAgICBhY3RpdmF0ZURlc3luYygpCiAgICB0YXNrLndhaXQoMC4xKQogICAgYWN0aXZhdGVDbG9uZXJEZXN5bmMoZnVuY3Rpb24oKQogICAgICAgIGRlYWN0aXZhdGVEZXN5bmMoKQogICAgICAgIGFudGlIaXRSdW5uaW5nID0gZmFsc2UKICAgICAgICBhbnRpSGl0QWN0aXZlID0gdHJ1ZQogICAgICAgIHNhdmVTZXR0aW5ncygpCiAgICBlbmQpCmVuZAoKbG9jYWwgZnVuY3Rpb24gZGVhY3RpdmF0ZUFkdmFuY2VkRGVzeW5jKCkKICAgIGlmIGFudGlIaXRSdW5uaW5nIHRoZW4KICAgICAgICBpZiBjbG9uZUxpc3RlbmVyQ29ubiB0aGVuCiAgICAgICAgICAgIGNsb25lTGlzdGVuZXJDb25uOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICBjbG9uZUxpc3RlbmVyQ29ubiA9IG5pbAogICAgICAgIGVuZAogICAgICAgIGFudGlIaXRSdW5uaW5nID0gZmFsc2UKICAgIGVuZAoKICAgIGRlYWN0aXZhdGVDbG9uZXJEZXN5bmMoKQogICAgZGVhY3RpdmF0ZURlc3luYygpCiAgICBhbnRpSGl0QWN0aXZlID0gZmFsc2UKCiAgICBpZiBwbGF5ZXIuQ2hhcmFjdGVyIHRoZW4gcmVtb3ZlSW52dWxuZXJhYmxlKHBsYXllci5DaGFyYWN0ZXIpIGVuZAoKICAgIGxvY2FsIHBvc3NpYmxlQ2xvbmUgPSBXb3Jrc3BhY2U6RmluZEZpcnN0Q2hpbGQodG9zdHJpbmcocGxheWVyLlVzZXJJZCkgLi4gIl9DbG9uZSIpCiAgICBpZiBwb3NzaWJsZUNsb25lIHRoZW4KICAgICAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgICAgIHJlbW92ZUludnVsbmVyYWJsZShwb3NzaWJsZUNsb25lKQogICAgICAgICAgICBwb3NzaWJsZUNsb25lOkRlc3Ryb3koKQogICAgICAgIGVuZCkKICAgIGVuZAoKICAgIGZvciBtb2RlbCwgXyBpbiBwYWlycyhkZXN5bmNIaWdobGlnaHRzKSBkbwogICAgICAgIHJlbW92ZURlc3luY0hpZ2hsaWdodChtb2RlbCkKICAgIGVuZAogICAgCiAgICByZW1vdmVBbGxIaWdobGlnaHRzKCkKICAgIAogICAgc2F2ZVNldHRpbmdzKCkKZW5kCgotLSBEZXlzbmMgQnV0dG9uIChTYcSfIMOcc3QgS8O2xZ9lKQpsb2NhbCBkZXN5bmNTY3JlZW5HdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCmRlc3luY1NjcmVlbkd1aS5OYW1lID0gIlF1YW50dW1EZXN5bmNCdXR0b24iCmRlc3luY1NjcmVlbkd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQpkZXN5bmNTY3JlZW5HdWkuWkluZGV4QmVoYXZpb3IgPSBFbnVtLlpJbmRleEJlaGF2aW9yLlNpYmxpbmcKZGVzeW5jU2NyZWVuR3VpLlBhcmVudCA9IENvcmVHdWkKCmxvY2FsIGRlc3luY0J1dHRvbiA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpCmRlc3luY0J1dHRvbi5OYW1lID0gIkRleXNuYyIKZGVzeW5jQnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMCwgMTIwLCAwLCA1MCkKZGVzeW5jQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDEsIC0xMzAsIDAsIDEwKSAtLSBTYcSfIMOcc3QgS8O2xZ9lCmRlc3luY0J1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTAwLCAyNTUpCmRlc3luY0J1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC40CmRlc3luY0J1dHRvbi5UZXh0ID0gIkRleXNuYyIKZGVzeW5jQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAwKQpkZXN5bmNCdXR0b24uVGV4dFNpemUgPSAxNApkZXN5bmNCdXR0b24uRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCmRlc3luY0J1dHRvbi5UZXh0V3JhcHBlZCA9IHRydWUKZGVzeW5jQnV0dG9uLkRyYWdnYWJsZSA9IHRydWUKZGVzeW5jQnV0dG9uLlBhcmVudCA9IGRlc3luY1NjcmVlbkd1aQoKbG9jYWwgZGVzeW5jQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCmRlc3luY0Nvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMikKZGVzeW5jQ29ybmVyLlBhcmVudCA9IGRlc3luY0J1dHRvbgoKbG9jYWwgZGVzeW5jU3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIpCmRlc3luY1N0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMjMwLCAyNTUpCmRlc3luY1N0cm9rZS5UaGlja25lc3MgPSAyCmRlc3luY1N0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjMKZGVzeW5jU3Ryb2tlLlBhcmVudCA9IGRlc3luY0J1dHRvbgoKZGVzeW5jQnV0dG9uLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGRlc3luY0J1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjIpLCB7CiAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMiwKICAgICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIH0pOlBsYXkoKQplbmQpCgpkZXN5bmNCdXR0b24uTW91c2VMZWF2ZTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoZGVzeW5jQnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMiksIHsKICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC40LAogICAgICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAwLCAwKQogICAgfSk6UGxheSgpCmVuZCkKCmRlc3luY0J1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIGlmIGFudGlIaXRSdW5uaW5nIHRoZW4KICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGRlc3luY0J1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjMpLCB7CiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDE2NSwgMCkKICAgICAgICB9KTpQbGF5KCkKICAgICAgICBkZXN5bmNCdXR0b24uVGV4dCA9ICJXb3JraW5nLi4uIgogICAgICAgIHJldHVybgogICAgZW5kCiAgICAKICAgIGlmIGFudGlIaXRBY3RpdmUgdGhlbgogICAgICAgIGRlYWN0aXZhdGVBZHZhbmNlZERlc3luYygpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShkZXN5bmNCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4zKSwgewogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTAwLCAyNTUpCiAgICAgICAgfSk6UGxheSgpCiAgICAgICAgZGVzeW5jQnV0dG9uLlRleHQgPSAiRGV5c25jIgogICAgZWxzZQogICAgICAgIGV4ZWN1dGVBZHZhbmNlZERlc3luYygpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShkZXN5bmNCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4zKSwgewogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMjAwLCAwKQogICAgICAgIH0pOlBsYXkoKQogICAgICAgIGRlc3luY0J1dHRvbi5UZXh0ID0gIkFjdGl2ZSIKICAgIGVuZAplbmQpCgotLSBEZXlzbmMgcmVzZXQKcGxheWVyLkNoYXJhY3RlckFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgdGFzay5kZWxheSgwLjMsIGZ1bmN0aW9uKCkKICAgICAgICBhbnRpSGl0QWN0aXZlID0gZmFsc2UKICAgICAgICBhbnRpSGl0UnVubmluZyA9IGZhbHNlCiAgICAgICAgY2xvbmVyQWN0aXZlID0gZmFsc2UKICAgICAgICBkZXN5bmNSdW5uaW5nID0gZmFsc2UKICAgICAgICBsb2NrZG93blJ1bm5pbmcgPSBmYWxzZQogICAgICAgIAogICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoZGVzeW5jQnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMyksIHsKICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDEwMCwgMjU1KQogICAgICAgIH0pOlBsYXkoKQogICAgICAgIGRlc3luY0J1dHRvbi5UZXh0ID0gIkRleXNuYyIKICAgICAgICAKICAgICAgICBsb2NhbCBjbG9uZSA9IFdvcmtzcGFjZTpGaW5kRmlyc3RDaGlsZCh0b3N0cmluZyhwbGF5ZXIuVXNlcklkKSAuLiAiX0Nsb25lIikKICAgICAgICBpZiBjbG9uZSB0aGVuCiAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHJlbW92ZUludnVsbmVyYWJsZShjbG9uZSkKICAgICAgICAgICAgICAgIGNsb25lOkRlc3Ryb3koKQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgcmVtb3ZlQWxsSGlnaGxpZ2h0cygpCiAgICBlbmQpCmVuZCkKCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLS0gViBMT0dPIEFORCBNQUlOIEdVSSBERVNJR04gLSAlNTAgS8Ocw4fDnExUw5xMTcOcxZ4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpsb2NhbCBwbGF5ZXJHdWkgPSBwbGF5ZXI6V2FpdEZvckNoaWxkKCdQbGF5ZXJHdWknKQoKLS0gQ2xlYW4gb2xkIEdVSXMKZG8KICAgIGxvY2FsIG9sZCA9IHBsYXllckd1aTpGaW5kRmlyc3RDaGlsZCgnVm9ydGV4SGVscGVyJykKICAgIGlmIG9sZCB0aGVuCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICBvbGQ6RGVzdHJveSgpCiAgICAgICAgZW5kKQogICAgZW5kCmVuZAoKLS0gViBMb2dvIEJ1dHRvbgpsb2NhbCBsb2dvR3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQpsb2dvR3VpLk5hbWUgPSAiVm9ydGV4TG9nbyIKbG9nb0d1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQpsb2dvR3VpLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5TaWJsaW5nCmxvZ29HdWkuUGFyZW50ID0gcGxheWVyR3VpCgpsb2NhbCBsb2dvQnV0dG9uID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIikKbG9nb0J1dHRvbi5OYW1lID0gIlZMb2dvIgpsb2dvQnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMCwgMzUsIDAsIDM1KQpsb2dvQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwLCAwLCAxMCkKbG9nb0J1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTIwLCAyNTUpCmxvZ29CdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMgpsb2dvQnV0dG9uLlRleHQgPSAiViIKbG9nb0J1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKbG9nb0J1dHRvbi5UZXh0U2l6ZSA9IDE2CmxvZ29CdXR0b24uRm9udCA9IEVudW0uRm9udC5Hb3RoYW1CbGFjawpsb2dvQnV0dG9uLkF1dG9CdXR0b25Db2xvciA9IGZhbHNlCmxvZ29CdXR0b24uRHJhZ2dhYmxlID0gdHJ1ZQpsb2dvQnV0dG9uLlBhcmVudCA9IGxvZ29HdWkKCmxvY2FsIGxvZ29Db3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKbG9nb0Nvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKQpsb2dvQ29ybmVyLlBhcmVudCA9IGxvZ29CdXR0b24KCmxvY2FsIGxvZ29TdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikKbG9nb1N0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMjMwLCAyNTUpCmxvZ29TdHJva2UuVGhpY2tuZXNzID0gMS41CmxvZ29TdHJva2UuUGFyZW50ID0gbG9nb0J1dHRvbgoKLS0gTWFpbiBHVUkKbG9jYWwgZ3VpID0gSW5zdGFuY2UubmV3KCdTY3JlZW5HdWknKQpndWkuTmFtZSA9ICdWb3J0ZXhIZWxwZXInCmd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQpndWkuWkluZGV4QmVoYXZpb3IgPSBFbnVtLlpJbmRleEJlaGF2aW9yLlNpYmxpbmcKZ3VpLlBhcmVudCA9IHBsYXllckd1aQoKLS0gTWFpbiBGcmFtZSAtICU1MCBLw5zDh8OcTFTDnExNw5zFngpsb2NhbCBtYWluRnJhbWUgPSBJbnN0YW5jZS5uZXcoJ0ZyYW1lJykKbWFpbkZyYW1lLlNpemUgPSBVRGltMi5uZXcoMCwgMTYwLCAwLCAxODApIC0tICU1MCBrw7zDp8O8bHTDvGxkw7wKbWFpbkZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTgwLCAwLjUsIC05MCkKbWFpbkZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyMCwgMjAsIDMwKQptYWluRnJhbWUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMQptYWluRnJhbWUuQm9yZGVyU2l6ZVBpeGVsID0gMAptYWluRnJhbWUuVmlzaWJsZSA9IGZhbHNlCm1haW5GcmFtZS5QYXJlbnQgPSBndWkKCmxvY2FsIG1haW5Db3JuZXIgPSBJbnN0YW5jZS5uZXcoJ1VJQ29ybmVyJywgbWFpbkZyYW1lKQptYWluQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDEwKQoKbG9jYWwgbWFpblN0cm9rZSA9IEluc3RhbmNlLm5ldygnVUlTdHJva2UnLCBtYWluRnJhbWUpCm1haW5TdHJva2UuVGhpY2tuZXNzID0gMgptYWluU3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMTAwLCAxNTAsIDI1NSkKbWFpblN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjIKCi0tIEhlYWRlciB3aXRoIFRhYnMKbG9jYWwgaGVhZGVyID0gSW5zdGFuY2UubmV3KCdGcmFtZScpCmhlYWRlci5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDMwKQpoZWFkZXIuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDMwLCAzMCwgNDUpCmhlYWRlci5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4xCmhlYWRlci5Cb3JkZXJTaXplUGl4ZWwgPSAwCmhlYWRlci5QYXJlbnQgPSBtYWluRnJhbWUKCmxvY2FsIGhlYWRlckNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQpoZWFkZXJDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTApCmhlYWRlckNvcm5lci5QYXJlbnQgPSBoZWFkZXIKCi0tIFRhYiBCdXR0b25zIC0gVUkgQ29ybmVyIEVLTEVORMSwCmxvY2FsIHRhYjFCdG4gPSBJbnN0YW5jZS5uZXcoJ1RleHRCdXR0b24nKQp0YWIxQnRuLk5hbWUgPSAnVGFiMScKdGFiMUJ0bi5TaXplID0gVURpbTIubmV3KDAuNSwgLTIsIDEsIDApCnRhYjFCdG4uUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMCkKdGFiMUJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMTIwLCAyNTUpCnRhYjFCdG4uVGV4dCA9ICJNQUlOIgp0YWIxQnRuLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQp0YWIxQnRuLlRleHRTaXplID0gMTEKdGFiMUJ0bi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKdGFiMUJ0bi5BdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQp0YWIxQnRuLlBhcmVudCA9IGhlYWRlcgoKbG9jYWwgdGFiMUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQp0YWIxQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDgpCnRhYjFDb3JuZXIuUGFyZW50ID0gdGFiMUJ0bgoKbG9jYWwgdGFiMkJ0biA9IEluc3RhbmNlLm5ldygnVGV4dEJ1dHRvbicpCnRhYjJCdG4uTmFtZSA9ICdUYWIyJwp0YWIyQnRuLlNpemUgPSBVRGltMi5uZXcoMC41LCAtMiwgMSwgMCkKdGFiMkJ0bi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAsIDApCnRhYjJCdG4uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDQwLCA0MCwgNjApCnRhYjJCdG4uVGV4dCA9ICJWSVNVQUwiCnRhYjJCdG4uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMjAwLCAyMDApCnRhYjJCdG4uVGV4dFNpemUgPSAxMQp0YWIyQnRuLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZAp0YWIyQnRuLkF1dG9CdXR0b25Db2xvciA9IGZhbHNlCnRhYjJCdG4uUGFyZW50ID0gaGVhZGVyCgpsb2NhbCB0YWIyQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCnRhYjJDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgOCkKdGFiMkNvcm5lci5QYXJlbnQgPSB0YWIyQnRuCgotLSBDb250ZW50IEFyZWFzCmxvY2FsIGNvbnRlbnRUYWIxID0gSW5zdGFuY2UubmV3KCdGcmFtZScpCmNvbnRlbnRUYWIxLk5hbWUgPSAnVGFiMUNvbnRlbnQnCmNvbnRlbnRUYWIxLlNpemUgPSBVRGltMi5uZXcoMSwgLTgsIDEsIC0zNSkKY29udGVudFRhYjEuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgNCwgMCwgMzEpCmNvbnRlbnRUYWIxLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCmNvbnRlbnRUYWIxLlZpc2libGUgPSB0cnVlCmNvbnRlbnRUYWIxLlBhcmVudCA9IG1haW5GcmFtZQoKbG9jYWwgY29udGVudFRhYjIgPSBJbnN0YW5jZS5uZXcoJ0ZyYW1lJykKY29udGVudFRhYjIuTmFtZSA9ICdUYWIyQ29udGVudCcKY29udGVudFRhYjIuU2l6ZSA9IFVEaW0yLm5ldygxLCAtOCwgMSwgLTM1KQpjb250ZW50VGFiMi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA0LCAwLCAzMSkKY29udGVudFRhYjIuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKY29udGVudFRhYjIuVmlzaWJsZSA9IGZhbHNlCmNvbnRlbnRUYWIyLlBhcmVudCA9IG1haW5GcmFtZQoKLS0gVGl0bGUKbG9jYWwgdGl0bGUgPSBJbnN0YW5jZS5uZXcoJ1RleHRMYWJlbCcsIGhlYWRlcikKdGl0bGUuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAxNSkKdGl0bGUuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMCwgMCkKdGl0bGUuVGV4dCA9ICdWT1JURVggSEVMUEVSJwp0aXRsZS5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTAwLCAyMDAsIDI1NSkKdGl0bGUuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCnRpdGxlLlRleHRTaXplID0gMTIKdGl0bGUuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKdGl0bGUuVGV4dFN0cm9rZVRyYW5zcGFyZW5jeSA9IDAuNwoKLS0gQnV0dG9uIENyZWF0aW9uIEZ1bmN0aW9uIC0gT3B0aW1pemUgRWRpbG1pxZ8KbG9jYWwgZnVuY3Rpb24gY3JlYXRlQnV0dG9uKHBhcmVudCwgdGV4dCwgeVBvcywgY2FsbGJhY2ssIGlzQWN0aXZlKQogICAgbG9jYWwgYnRuID0gSW5zdGFuY2UubmV3KCdUZXh0QnV0dG9uJywgcGFyZW50KQogICAgYnRuLlNpemUgPSBVRGltMi5uZXcoMC45NSwgMCwgMCwgMjUpCiAgICBidG4uUG9zaXRpb24gPSBVRGltMi5uZXcoMC4wMjUsIDAsIDAsIHlQb3MpCiAgICBidG4uQmFja2dyb3VuZENvbG9yMyA9IGlzQWN0aXZlIGFuZCBDb2xvcjMuZnJvbVJHQig2MCwgMjIwLCAxMDApIG9yIENvbG9yMy5mcm9tUkdCKDIyMCwgNjAsIDYwKQogICAgYnRuLlRleHQgPSB0ZXh0CiAgICBidG4uRm9udCA9IEVudW0uRm9udC5Hb3RoYW1TZW1pYm9sZAogICAgYnRuLlRleHRDb2xvcjMgPSBDb2xvcjMubmV3KDEsIDEsIDEpCiAgICBidG4uVGV4dFNpemUgPSAxMAogICAgYnRuLkJvcmRlclNpemVQaXhlbCA9IDAKICAgIGJ0bi5BdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQogICAgCiAgICBsb2NhbCBidG5Db3JuZXIgPSBJbnN0YW5jZS5uZXcoJ1VJQ29ybmVyJywgYnRuKQogICAgYnRuQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDYpCiAgICAKICAgIGxvY2FsIGJ0blN0cm9rZSA9IEluc3RhbmNlLm5ldygnVUlTdHJva2UnLCBidG4pCiAgICBidG5TdHJva2UuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgYnRuU3Ryb2tlLlRoaWNrbmVzcyA9IDEKICAgIGJ0blN0cm9rZS5UcmFuc3BhcmVuY3kgPSAwLjMKICAgIAogICAgYnRuLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShidG4sIFR3ZWVuSW5mby5uZXcoMC4yKSwgewogICAgICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4xCiAgICAgICAgfSk6UGxheSgpCiAgICBlbmQpCiAgICAKICAgIGJ0bi5Nb3VzZUxlYXZlOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoYnRuLCBUd2VlbkluZm8ubmV3KDAuMiksIHsKICAgICAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAKICAgICAgICB9KTpQbGF5KCkKICAgIGVuZCkKICAgIAogICAgYnRuLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoY2FsbGJhY2spCiAgICByZXR1cm4gYnRuCmVuZAoKLS0gViBMb2dvIGNsaWNrIGV2ZW50CmxvY2FsIG1haW5GcmFtZVZpc2libGUgPSBmYWxzZQpsb2dvQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgbWFpbkZyYW1lVmlzaWJsZSA9IG5vdCBtYWluRnJhbWVWaXNpYmxlCiAgICBtYWluRnJhbWUuVmlzaWJsZSA9IG1haW5GcmFtZVZpc2libGUKZW5kKQoKLS0gTG9nbyBob3ZlciBlZmZlY3QKbG9nb0J1dHRvbi5Nb3VzZUVudGVyOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShsb2dvQnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMiksIHsKICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4xLAogICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMzcsIDAsIDM3KQogICAgfSk6UGxheSgpCmVuZCkKCmxvZ29CdXR0b24uTW91c2VMZWF2ZTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIFR3ZWVuU2VydmljZTpDcmVhdGUobG9nb0J1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjIpLCB7CiAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMiwKICAgICAgICBTaXplID0gVURpbTIubmV3KDAsIDM1LCAwLCAzNSkKICAgIH0pOlBsYXkoKQplbmQpCgotLSBUYWIgc3dpdGNoaW5nIGZ1bmN0aW9uCmxvY2FsIGN1cnJlbnRUYWIgPSAxCgpsb2NhbCBmdW5jdGlvbiBzd2l0Y2hUYWIodGFiTnVtYmVyKQogICAgY3VycmVudFRhYiA9IHRhYk51bWJlcgogICAgCiAgICBjb250ZW50VGFiMS5WaXNpYmxlID0gZmFsc2UKICAgIGNvbnRlbnRUYWIyLlZpc2libGUgPSBmYWxzZQogICAgCiAgICB0YWIxQnRuLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig0MCwgNDAsIDYwKQogICAgdGFiMkJ0bi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNDAsIDQwLCA2MCkKICAgIAogICAgdGFiMUJ0bi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAwLCAyMDAsIDIwMCkKICAgIHRhYjJCdG4uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMjAwLCAyMDApCiAgICAKICAgIGlmIHRhYk51bWJlciA9PSAxIHRoZW4KICAgICAgICBjb250ZW50VGFiMS5WaXNpYmxlID0gdHJ1ZQogICAgICAgIHRhYjFCdG4uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDEyMCwgMjU1KQogICAgICAgIHRhYjFCdG4uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCiAgICBlbHNlCiAgICAgICAgY29udGVudFRhYjIuVmlzaWJsZSA9IHRydWUKICAgICAgICB0YWIyQnRuLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAxMjAsIDI1NSkKICAgICAgICB0YWIyQnRuLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgZW5kCmVuZAoKLS0gVGFiIGJ1dHRvbiBldmVudHMKdGFiMUJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkgc3dpdGNoVGFiKDEpIGVuZCkKdGFiMkJ0bi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkgc3dpdGNoVGFiKDIpIGVuZCkKCi0tIExvYWQgc2V0dGluZ3MKbG9jYWwgc2V0dGluZ3MgPSBsb2FkU2V0dGluZ3MoKQoKLS0gQXBwbHkgc2V0dGluZ3MKaWYgc2V0dGluZ3MuaW5mSnVtcCB+PSBuaWwgdGhlbgogICAgZ3Jhdml0eUxvdyA9IHNldHRpbmdzLmluZkp1bXAKZW5kCgppZiBzZXR0aW5ncy5lc3BCYXNlIH49IG5pbCB0aGVuCiAgICBlc3BCYXNlQWN0aXZlID0gc2V0dGluZ3MuZXNwQmFzZQogICAgaWYgZXNwQmFzZUFjdGl2ZSB0aGVuCiAgICAgICAgdG9nZ2xlQmFzZUVTUCgpCiAgICBlbmQKZW5kCgppZiBzZXR0aW5ncy5lc3BCZXN0IH49IG5pbCB0aGVuCiAgICBlc3BCZXN0QWN0aXZlID0gc2V0dGluZ3MuZXNwQmVzdAogICAgaWYgZXNwQmVzdEFjdGl2ZSB0aGVuCiAgICAgICAgdG9nZ2xlQmVzdEVTUCgpCiAgICBlbmQKZW5kCgppZiBzZXR0aW5ncy5kZXN5bmMgfj0gbmlsIHRoZW4KICAgIGFudGlIaXRBY3RpdmUgPSBzZXR0aW5ncy5kZXN5bmMKICAgIGlmIGFudGlIaXRBY3RpdmUgdGhlbgogICAgICAgIGRlc3luY0J1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMjAwLCAwKQogICAgICAgIGRlc3luY0J1dHRvbi5UZXh0ID0gIkFjdGl2ZSIKICAgIGVuZAplbmQKCmlmIHNldHRpbmdzLmZwc0Rldm91cmVyIH49IG5pbCB0aGVuCiAgICBmcHNEZXZvdXJlckFjdGl2ZSA9IHNldHRpbmdzLmZwc0Rldm91cmVyCiAgICBpZiBmcHNEZXZvdXJlckFjdGl2ZSB0aGVuCiAgICAgICAgZW5hYmxlRlBTRGV2b3VyZXIoKQogICAgZW5kCmVuZAoKaWYgc2V0dGluZ3MucGxheWVyRVNQIH49IG5pbCB0aGVuCiAgICBwbGF5ZXJFc3BBY3RpdmUgPSBzZXR0aW5ncy5wbGF5ZXJFU1AKICAgIGlmIHBsYXllckVzcEFjdGl2ZSB0aGVuCiAgICAgICAgdG9nZ2xlUGxheWVyRVNQKCkKICAgIGVuZAplbmQKCmlmIHNldHRpbmdzLnN0ZWFsRmxvb3Igfj0gbmlsIHRoZW4KICAgIHN0ZWFsRmxvb3JBY3RpdmUgPSBzZXR0aW5ncy5zdGVhbEZsb29yCiAgICBpZiBzdGVhbEZsb29yQWN0aXZlIHRoZW4KICAgICAgICBzdGVhbEZsb29yQnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMjAsIDI1NSwgMTIwKQogICAgICAgIHN0ZWFsRmxvb3JCdXR0b24uVGV4dCA9ICLinIUgU3RlYWwgRmxvb3IiCiAgICBlbmQKZW5kCgotLSBDcmVhdGUgYnV0dG9ucyBmb3IgVGFiIDEgKE1haW4pIC0gT3B0aW1pemUgRWRpbG1pxZ8KbG9jYWwgeVBvcyA9IDUKY3JlYXRlQnV0dG9uKGNvbnRlbnRUYWIxLCBmcHNEZXZvdXJlckFjdGl2ZSBhbmQgJ+KchSBGUFMnIG9yICfwn46vIEZQUycsIHlQb3MsIHRvZ2dsZUZQU0Rldm91cmVyLCBmcHNEZXZvdXJlckFjdGl2ZSkKeVBvcyA9IHlQb3MgKyAyOApjcmVhdGVCdXR0b24oY29udGVudFRhYjEsIGdyYXZpdHlMb3cgYW5kICfinIUgSnVtcCcgb3IgJ/CfppggSnVtcCcsIHlQb3MsIHN3aXRjaEdyYXZpdHlKdW1wLCBncmF2aXR5TG93KQp5UG9zID0geVBvcyArIDI4CmNyZWF0ZUJ1dHRvbihjb250ZW50VGFiMSwgJ/CfmoAgRmx5IEJhc2UnLCB5UG9zLCBzdGFydEZseVRvQmFzZSwgZmFsc2UpCgotLSBDcmVhdGUgYnV0dG9ucyBmb3IgVGFiIDIgKFZpc3VhbCkgLSBPcHRpbWl6ZSBFZGlsbWnFnwp5UG9zID0gNQpjcmVhdGVCdXR0b24oY29udGVudFRhYjIsIGVzcEJhc2VBY3RpdmUgYW5kICfinIUgQmFzZScgb3IgJ/Cfj6AgQmFzZScsIHlQb3MsIHRvZ2dsZUJhc2VFU1AsIGVzcEJhc2VBY3RpdmUpCnlQb3MgPSB5UG9zICsgMjgKY3JlYXRlQnV0dG9uKGNvbnRlbnRUYWIyLCBlc3BCZXN0QWN0aXZlIGFuZCAn4pyFIEJlc3QnIG9yICfwn5SlIEJlc3QnLCB5UG9zLCB0b2dnbGVCZXN0RVNQLCBlc3BCZXN0QWN0aXZlKQp5UG9zID0geVBvcyArIDI4CmNyZWF0ZUJ1dHRvbihjb250ZW50VGFiMiwgcGxheWVyRXNwQWN0aXZlIGFuZCAn4pyFIFBsYXllcicgb3IgJ/CfkaUgUGxheWVyJywgeVBvcywgdG9nZ2xlUGxheWVyRVNQLCBwbGF5ZXJFc3BBY3RpdmUpCgotLSBEcmFnIGZ1bmN0aW9uYWxpdHkgZm9yIG1haW4gZnJhbWUKbG9jYWwgZHJhZ2dpbmcgPSBmYWxzZQpsb2NhbCBkcmFnSW5wdXQsIGRyYWdTdGFydCwgc3RhcnRQb3MKCm1haW5GcmFtZS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZUJ1dHRvbjEgdGhlbgogICAgICAgIGRyYWdnaW5nID0gdHJ1ZQogICAgICAgIGRyYWdTdGFydCA9IGlucHV0LlBvc2l0aW9uCiAgICAgICAgc3RhcnRQb3MgPSBtYWluRnJhbWUuUG9zaXRpb24KICAgICAgICAKICAgICAgICBpbnB1dC5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRTdGF0ZSA9PSBFbnVtLlVzZXJJbnB1dFN0YXRlLkVuZCB0aGVuCiAgICAgICAgICAgICAgICBkcmFnZ2luZyA9IGZhbHNlCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAplbmQpCgptYWluRnJhbWUuSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Nb3VzZU1vdmVtZW50IHRoZW4KICAgICAgICBkcmFnSW5wdXQgPSBpbnB1dAogICAgZW5kCmVuZCkKClVzZXJJbnB1dFNlcnZpY2UuSW5wdXRDaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQpCiAgICBpZiBpbnB1dCA9PSBkcmFnSW5wdXQgYW5kIGRyYWdnaW5nIHRoZW4KICAgICAgICBsb2NhbCBkZWx0YSA9IGlucHV0LlBvc2l0aW9uIC0gZHJhZ1N0YXJ0CiAgICAgICAgbWFpbkZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KAogICAgICAgICAgICBzdGFydFBvcy5YLlNjYWxlLAogICAgICAgICAgICBzdGFydFBvcy5YLk9mZnNldCArIGRlbHRhLlgsCiAgICAgICAgICAgIHN0YXJ0UG9zLlkuU2NhbGUsCiAgICAgICAgICAgIHN0YXJ0UG9zLlkuT2Zmc2V0ICsgZGVsdGEuWQogICAgICAgICkKICAgIGVuZAplbmQpCgotLSBFbmFibGUgRlBTIERldm91cmVyIG9uIHN0YXJ0IGlmIHNhdmVkCmlmIG5vdCBmcHNEZXZvdXJlckFjdGl2ZSB0aGVuCiAgICBlbmFibGVGUFNEZXZvdXJlcigpCmVuZAoKLS0gU3RhcnR1cCBub3RpZmljYXRpb24Kc2hvd05vdGlmaWNhdGlvbigiVm9ydGV4J3MgSGVscGVyIExvYWRlZCEiLCB0cnVlKQoKLS0gRGlzYWJsZSBmdXR1cmUgbm90aWZpY2F0aW9ucyBhZnRlciAzIHNlY29uZHMKd2FpdCgzKQpzdGFydHVwTm90aWZpY2F0aW9ucyA9IGZhbHNlCgpwcmludCgi8J+OryBWb3J0ZXgncyBIZWxwZXIgTG9hZGVkISIpCnByaW50KCLinIUgRlBTIERldm91cmVyIEFjdGl2ZSIpCnByaW50KCLwn6aYIEluZiBKdW1wIFJlYWR5ICgzMCBQb3dlcikgLSBXYWxrIFNwZWVkIFlPSyIpCnByaW50KCLwn5qAIEZseSB0byBCYXNlIFJlYWR5IikKcHJpbnQoIvCfj6AgRVNQIEJhc2UgUmVhZHkiKQpwcmludCgi8J+UpSBFU1AgQmVzdCBSZWFkeSIpCnByaW50KCLwn5GlIFBsYXllciBFU1AgUmVhZHkiKQpwcmludCgi8J+Pl++4jyBTdGVhbCBGbG9vciBSZWFkeSAoU29sIEFsdCBLw7bFn2UpIikKcHJpbnQoIvCfjIAgRGV5c25jIFN5c3RlbSBSZWFkeSAoU2HEnyDDnHN0IEvDtsWfZSkiKQpwcmludCgi8J+UtyBWIExvZ286IENsaWNrIHRvIG9wZW4vY2xvc2UgbWFpbiBtZW51IikKcHJpbnQoIvCfkr4gU2V0dGluZ3MgU2F2aW5nOiBWb3J0ZXgnc0hlbHBlciBGb2xkZXIiKQ=="
local decoded = base64_decode(encoded)
loadstring(decoded)()

function base64_decode(data)
    local b = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
    data = string.gsub(data, '[^'..b..'=]', '')
    return (data:gsub('.', function(x)
        if (x == '=') then return '' end
        local r,f='',(b:find(x)-1)
        for i=6,1,-1 do r=r..(f%2^i-f%2^(i-1)>0 and '1' or '0') end
        return r;
    end):gsub('%d%d%d?%d?%d?%d?%d?%d?', function(x)
        if (#x ~= 8) then return '' end
        local c=0
        for i=1,8 do c=c+(x:sub(i,i)=='1' and 2^(8-i) or 0) end
        return string.char(c)
    end))
end
